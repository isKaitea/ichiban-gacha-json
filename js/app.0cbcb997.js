(function(){"use strict";var t={2956:function(t,e,s){var a=s(5130),i=s(6768),n=s(4232);const l={class:"navbar navbar-expand-lg bg-white border-bottom sticky-top"},r={class:"container"},o={class:"collapse navbar-collapse",id:"navMenu"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},c={class:"nav-item"},m={class:"nav-item"},u={class:"nav-item"},h={class:"nav-item"},k={key:0,class:"nav-item"},b={class:"d-flex gap-2"},g={key:0,class:"btn btn-outline-danger","data-bs-toggle":"modal","data-bs-target":"#loginModal"},p={key:1,class:"d-flex align-items-center gap-2"},v={class:"small text-muted"},f={key:0,class:"badge text-bg-primary ms-1"},w={class:"container py-4"},L={class:"modal fade",id:"loginModal",tabindex:"-1"},y={class:"modal-dialog modal-dialog-centered"},C={class:"modal-content"},_={class:"modal-body"},x={class:"mb-3"},E={class:"mb-3"},S={class:"mt-3 small text-muted d-flex justify-content-between"},X={key:0,class:"alert alert-danger mt-3 py-2 mb-0"};function P(t,e,s,P,D,z){const I=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("nav",l,[(0,i.Lk)("div",r,[(0,i.Lk)("a",{class:"navbar-brand fw-bold text-danger",href:"#",onClick:e[0]||(e[0]=(0,a.D$)((...t)=>z.goHome&&z.goHome(...t),["prevent"]))}," ä¸€ç•ªè³ž "),e[12]||(e[12]=(0,i.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navMenu"},[(0,i.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,i.Lk)("div",o,[(0,i.Lk)("ul",d,[(0,i.Lk)("li",c,[(0,i.Lk)("a",{class:"nav-link",href:"#news",onClick:e[1]||(e[1]=(0,a.D$)(t=>z.jumpTo("news"),["prevent"]))},"æœ€æ–°æ¶ˆæ¯")]),(0,i.Lk)("li",m,[(0,i.Lk)("a",{class:"nav-link",href:"#hot",onClick:e[2]||(e[2]=(0,a.D$)(t=>z.jumpTo("hot"),["prevent"]))},"æœ€ç†±é–€")]),(0,i.Lk)("li",u,[(0,i.Lk)("a",{class:"nav-link",href:"#latest",onClick:e[3]||(e[3]=(0,a.D$)(t=>z.jumpTo("latest"),["prevent"]))},"æœ€æ–°ä¸Šæž¶")]),(0,i.Lk)("li",h,[(0,i.Lk)("a",{class:"nav-link",href:"#about",onClick:e[4]||(e[4]=(0,a.D$)(t=>z.jumpTo("about"),["prevent"]))},"é—œæ–¼æˆ‘å€‘")]),z.isAdmin?((0,i.uX)(),(0,i.CE)("li",k,[(0,i.Lk)("a",{class:"nav-link fw-bold text-primary",href:"#",onClick:e[5]||(e[5]=(0,a.D$)((...t)=>z.goAdmin&&z.goAdmin(...t),["prevent"]))}," ç®¡ç†ä¸€ç•ªè³ž ")])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",b,[z.isLoggedIn?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("span",v,[(0,i.eW)(" å—¨ï¼Œ"+(0,n.v_)(D.user.name)+" ",1),z.isAdmin?((0,i.uX)(),(0,i.CE)("span",f,"Admin")):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:e[6]||(e[6]=(...t)=>z.logout&&z.logout(...t))},"ç™»å‡º")])):((0,i.uX)(),(0,i.CE)("button",g," ç™»å…¥ "))])])])]),(0,i.Lk)("main",w,[(0,i.bF)(I)]),(0,i.Lk)("div",L,[(0,i.Lk)("div",y,[(0,i.Lk)("div",C,[e[16]||(e[16]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title fw-bold"},"ç™»å…¥"),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),(0,i.Lk)("div",_,[(0,i.Lk)("div",x,[e[13]||(e[13]=(0,i.Lk)("label",{class:"form-label"},"å¸³è™Ÿ",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>D.loginForm.account=t),type:"text",class:"form-control",placeholder:"è¼¸å…¥å¸³è™Ÿ"},null,512),[[a.Jo,D.loginForm.account,void 0,{trim:!0}]])]),(0,i.Lk)("div",E,[e[14]||(e[14]=(0,i.Lk)("label",{class:"form-label"},"å¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>D.loginForm.password=t),type:"password",class:"form-control",placeholder:"è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,D.loginForm.password,void 0,{trim:!0}]])]),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:e[9]||(e[9]=(...t)=>z.submitLogin&&z.submitLogin(...t))},"ç™»å…¥"),(0,i.Lk)("div",S,[(0,i.Lk)("a",{href:"#",onClick:e[10]||(e[10]=(0,a.D$)((...t)=>z.forgotPassword&&z.forgotPassword(...t),["prevent"]))},"å¿˜è¨˜å¯†ç¢¼ï¼Ÿ"),(0,i.Lk)("a",{href:"#",onClick:e[11]||(e[11]=(0,a.D$)((...t)=>z.goRegister&&z.goRegister(...t),["prevent"]))},"è¨»å†Š")]),D.loginError?((0,i.uX)(),(0,i.CE)("div",X,(0,n.v_)(D.loginError),1)):(0,i.Q3)("",!0),e[15]||(e[15]=(0,i.Lk)("div",{class:"alert alert-warning mt-3 py-2 mb-0"}," æ‰“ç‰ˆç™»å…¥ï¼šadmin/1234ï¼ˆç®¡ç†è€…ï¼‰ã€user/1234ï¼ˆä¸€èˆ¬ï¼‰ ",-1))])])])])])}s(4114),s(3110),s(8335);var D={name:"App",data(){return{loginForm:{account:"",password:""},loginError:"",user:this.loadUser()}},computed:{isLoggedIn(){return!!this.user},isAdmin(){return"admin"===this.user?.role}},methods:{loadUser(){try{const t=localStorage.getItem("mock_user");return t?JSON.parse(t):null}catch{return null}},saveUser(t){this.user=t,localStorage.setItem("mock_user",JSON.stringify(t))},clearUser(){this.user=null,localStorage.removeItem("mock_user")},closeModalById(t){const e=document.getElementById(t);if(!e||!window.bootstrap)return;const s=window.bootstrap.Modal.getInstance(e)||new window.bootstrap.Modal(e);s.hide()},async jumpTo(t){"/"!==this.$route.path&&await this.$router.push("/"),this.$nextTick(()=>{const e=document.getElementById(t);e&&e.scrollIntoView({behavior:"smooth",block:"start"})})},goHome(){this.$router.push("/")},goRegister(){this.closeModalById("loginModal"),this.$router.push("/register")},goAdmin(){this.$router.push("/admin/series")},forgotPassword(){alert("æ‰“ç‰ˆï¼šå¿˜è¨˜å¯†ç¢¼ä¹‹å¾Œå¯åš Email / OTP / é‡è¨­æµç¨‹ã€‚")},submitLogin(){this.loginError="";const t=this.loginForm.account,e=this.loginForm.password;if(("admin"===t||"user"===t)&&"1234"===e){const e={id:"admin"===t?1:2,name:"admin"===t?"ç®¡ç†è€…":"ä¸€èˆ¬ä½¿ç”¨è€…",role:"admin"===t?"admin":"buyer"};return this.saveUser(e),this.loginForm.account="",this.loginForm.password="",void this.closeModalById("loginModal")}this.loginError="å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼ˆæ‰“ç‰ˆï¼šadmin/1234 æˆ– user/1234ï¼‰"},logout(){this.clearUser(),alert("å·²ç™»å‡º")}}},z=s(1241);const I=(0,z.A)(D,[["render",P]]);var j=I,T=s(8728);const M={class:"p-4 p-md-5 mb-4 rounded-4 bg-white border shadow-sm"},N={class:"row align-items-center g-3"},$={class:"col-12 col-lg-8"},A={class:"d-flex gap-2 flex-wrap"},F={class:"col-12 col-lg-4"},O={class:"rounded-4 bg-light border p-3"},Q={key:0,class:"fw-bold"},U={key:1,class:"text-danger fw-bold"},V={key:2,class:"fw-bold"},J={id:"news",class:"mb-4"},R={class:"d-flex align-items-center justify-content-between mb-2"},K={class:"list-group shadow-sm"},B={class:"me-3"},H={class:"fw-semibold"},q={class:"small text-muted"},G={class:"badge text-bg-light border"},W={id:"hot",class:"mb-4"},Y={class:"d-flex align-items-center justify-content-between mb-2"},Z={key:0,class:"text-muted"},tt={key:1,class:"alert alert-danger py-2"},et={key:2,class:"row g-3"},st=["onClick"],at=["src","alt"],it={class:"card-body"},nt={class:"d-flex justify-content-between align-items-start gap-2"},lt={class:"h6 fw-bold mb-1"},rt={class:"badge text-bg-danger"},ot={class:"small text-muted mb-2"},dt={class:"card-text text-muted small clamp-2"},ct={key:0,class:"text-muted"},mt={id:"latest",class:"mb-4"},ut={class:"d-flex align-items-center justify-content-between mb-2"},ht={key:0,class:"text-muted"},kt={key:1,class:"alert alert-danger py-2"},bt={key:2,class:"row g-3"},gt=["onClick"],pt=["src","alt"],vt={class:"card-body"},ft={class:"d-flex justify-content-between align-items-start gap-2"},wt={class:"h6 fw-bold mb-1"},Lt={class:"badge text-bg-danger"},yt={class:"small text-muted mb-2"},Ct={key:0},_t={class:"card-text text-muted small clamp-2"},xt={key:0,class:"text-muted"};function Et(t,e,s,a,l,r){return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",M,[(0,i.Lk)("div",N,[(0,i.Lk)("div",$,[e[6]||(e[6]=(0,i.Lk)("h1",{class:"fw-bold mb-2"},"ä¸€ç•ªè³žæŠ½çŽç¶²ç«™",-1)),e[7]||(e[7]=(0,i.Lk)("p",{class:"text-muted mb-3"}," ç›®å‰ä½¿ç”¨ JSON Mock DBï¼ˆpublic/mock-dbï¼‰ï¼Œä¹‹å¾ŒæœƒæŽ¥ Go + MySQLã€‚ ",-1)),(0,i.Lk)("div",A,[(0,i.Lk)("button",{class:"btn btn-danger",onClick:e[0]||(e[0]=t=>r.scrollTo("hot"))},"çœ‹æœ€ç†±é–€"),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:e[1]||(e[1]=t=>r.scrollTo("latest"))},"çœ‹æœ€æ–°ä¸Šæž¶"),(0,i.Lk)("button",{class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=t=>r.scrollTo("news"))},"çœ‹æœ€æ–°æ¶ˆæ¯")])]),(0,i.Lk)("div",F,[(0,i.Lk)("div",O,[e[8]||(e[8]=(0,i.Lk)("div",{class:"small text-muted mb-1"},"ç‹€æ…‹",-1)),l.loading?((0,i.uX)(),(0,i.CE)("div",Q,"è®€å–ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",U,"è¼‰å…¥å¤±æ•—")):((0,i.uX)(),(0,i.CE)("div",V," å·²è¼‰å…¥ "+(0,n.v_)(l.gachas.length)+" å¥—ä¸€ç•ªè³ž ",1)),e[9]||(e[9]=(0,i.Lk)("div",{class:"small text-muted mt-2"}," æª”æ¡ˆï¼š/mock-db/gachas.json ",-1))])])])]),(0,i.Lk)("section",J,[(0,i.Lk)("div",R,[e[10]||(e[10]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€æ–°æ¶ˆæ¯",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[3]||(e[3]=(...t)=>r.goNews&&r.goNews(...t))},"æ›´å¤š")]),(0,i.Lk)("div",K,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.newsList,t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"list-group-item d-flex justify-content-between align-items-start"},[(0,i.Lk)("div",B,[(0,i.Lk)("div",H,(0,n.v_)(t.title),1),(0,i.Lk)("div",q,(0,n.v_)(t.desc),1)]),(0,i.Lk)("span",G,(0,n.v_)(t.date),1)]))),128))])]),(0,i.Lk)("section",W,[(0,i.Lk)("div",Y,[e[11]||(e[11]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€ç†±é–€",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[4]||(e[4]=t=>r.goSeriesList("hot"))},"æ›´å¤š")]),l.loading?((0,i.uX)(),(0,i.CE)("div",Z,"è¼‰å…¥ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",tt," è®€å–å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",et,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.hotGachas,t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:e=>r.goSeriesDetail(t)},[(0,i.Lk)("img",{src:t.image_url,class:"card-img-top",alt:t.name,style:{height:"180px","object-fit":"cover"}},null,8,at),(0,i.Lk)("div",it,[(0,i.Lk)("div",nt,[(0,i.Lk)("h3",lt,(0,n.v_)(t.name),1),(0,i.Lk)("span",rt,"å–®æŠ½ "+(0,n.v_)(t.price),1)]),(0,i.Lk)("div",ot," â¤ "+(0,n.v_)(t.like_count||0)+" Â· é»žæ“Š "+(0,n.v_)(t.show_n||0),1),(0,i.Lk)("p",dt,(0,n.v_)(t.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1)])],8,st)]))),128)),0===r.hotGachas.length?((0,i.uX)(),(0,i.CE)("div",ct,"ç›®å‰æ²’æœ‰è³‡æ–™")):(0,i.Q3)("",!0)]))]),(0,i.Lk)("section",mt,[(0,i.Lk)("div",ut,[e[12]||(e[12]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€æ–°ä¸Šæž¶",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[5]||(e[5]=t=>r.goSeriesList("latest"))},"æ›´å¤š")]),l.loading?((0,i.uX)(),(0,i.CE)("div",ht,"è¼‰å…¥ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",kt," è®€å–å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",bt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.latestGachas,t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:e=>r.goSeriesDetail(t)},[(0,i.Lk)("img",{src:t.image_url,class:"card-img-top",alt:t.name,style:{height:"180px","object-fit":"cover"}},null,8,pt),(0,i.Lk)("div",vt,[(0,i.Lk)("div",ft,[(0,i.Lk)("h3",wt,(0,n.v_)(t.name),1),(0,i.Lk)("span",Lt,"å–®æŠ½ "+(0,n.v_)(t.price),1)]),(0,i.Lk)("div",yt,[(0,i.eW)(" ç¸½æŠ½æ•¸ "+(0,n.v_)(t.total_draws||"-")+" ",1),t.created_at?((0,i.uX)(),(0,i.CE)("span",Ct,"Â· "+(0,n.v_)(r.formatDate(t.created_at)),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("p",_t,(0,n.v_)(t.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1)])],8,gt)]))),128)),0===r.latestGachas.length?((0,i.uX)(),(0,i.CE)("div",xt,"ç›®å‰æ²’æœ‰è³‡æ–™")):(0,i.Q3)("",!0)]))]),e[13]||(e[13]=(0,i.Lk)("section",{id:"about",class:"mt-4"},[(0,i.Lk)("div",{class:"p-4 rounded-4 bg-white border shadow-sm"},[(0,i.Lk)("h2",{class:"h5 fw-bold mb-2"},"é—œæ–¼æˆ‘å€‘"),(0,i.Lk)("p",{class:"text-muted mb-0"}," é€™æ˜¯èª²å ‚/å°ˆé¡Œç”¨çš„ä¸€ç•ªè³žç¶²ç«™æ‰“ç‰ˆã€‚ç¾éšŽæ®µä½¿ç”¨ JSON Mock DBï¼Œ å¾ŒçºŒæœƒæŽ¥ Go API + MySQLï¼Œè®“æŠ½çŽã€åº«å­˜ã€æ”¶è—ã€ç®¡ç†åŠŸèƒ½æ›´å®Œæ•´ã€‚ ")])],-1))])}var St={name:"HomeView",data(){return{loading:!0,error:null,gachas:[],newsList:[{id:1,date:"2025/12/15",title:"ã€å…¬å‘Šã€‘æœ¬é€±æ–°å¢žä¸€ç•ªè³žä¸Šæž¶ï¼",desc:"æ‰“ç‰ˆè³‡æ–™ï¼šä¹‹å¾Œå¯ç”±å¾Œå°æ–°å¢žã€‚"},{id:2,date:"2025/12/15",title:"ã€æ´»å‹•ã€‘æœƒå“¡æŠ½åé€ä¸€ï¼ˆç¤ºæ„ï¼‰",desc:"æ­£å¼ç‰ˆæœƒä¾æŠ½çŽç´€éŒ„è¨ˆç®—ã€‚"},{id:3,date:"2025/12/15",title:"ã€æé†’ã€‘æœ€å¾Œè³žåƒ…æœ€å¾Œä¸€æŠ½ç²å¾—",desc:"æŠ½çŽé‚è¼¯æœƒåœ¨è©³æƒ…é å¯¦ä½œã€‚"}]}},computed:{hotGachas(){const t=[...this.gachas];return t.sort((t,e)=>{const s=(t.show_n||0)+(t.like_count||0),a=(e.show_n||0)+(e.like_count||0);return a-s}),t.slice(0,6)},latestGachas(){const t=[...this.gachas];return t.sort((t,e)=>{const s=t.created_at?Date.parse(t.created_at):t.id,a=e.created_at?Date.parse(e.created_at):e.id;return a-s}),t.slice(0,6)}},async mounted(){try{const t=await fetch("/mock-db/gachas.json");if(!t.ok)throw new Error("gachas.json HTTP "+t.status);const e=await t.json();this.gachas=Array.isArray(e)?e:e.items||[]}catch(t){this.error=t.message||String(t)}finally{this.loading=!1}},methods:{scrollTo(t){const e=document.getElementById(t);e&&e.scrollIntoView({behavior:"smooth",block:"start"})},formatDate(t){try{const e=new Date(t);return`${e.getFullYear()}/${String(e.getMonth()+1).padStart(2,"0")}/${String(e.getDate()).padStart(2,"0")}`}catch{return""}},goNews(){this.$router.push("/news")},goSeriesList(t){this.$router.push({path:"/series",query:{mode:t}})},goSeriesDetail(t){this.$router.push({name:"seriesDetail",params:{id:t.id}})}}};const Xt=(0,z.A)(St,[["render",Et],["__scopeId","data-v-58934129"]]);var Pt=Xt;const Dt={class:"row justify-content-center"},zt={class:"col-12 col-md-7 col-lg-5"},It={class:"card shadow-sm"},jt={class:"card-body p-4"},Tt={class:"mb-3"},Mt={class:"mb-3"},Nt={class:"mb-3"},$t={class:"mb-3"},At={key:0,class:"alert alert-info mt-3 mb-0 py-2"},Ft={class:"mt-3 text-center small"};function Ot(t,e,s,l,r,o){return(0,i.uX)(),(0,i.CE)("div",Dt,[(0,i.Lk)("div",zt,[(0,i.Lk)("div",It,[(0,i.Lk)("div",jt,[e[11]||(e[11]=(0,i.Lk)("h2",{class:"h4 fw-bold mb-3"},"è¨»å†Š",-1)),(0,i.Lk)("div",Tt,[e[6]||(e[6]=(0,i.Lk)("label",{class:"form-label"},"é¡¯ç¤ºåç¨±",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.name=t),class:"form-control",placeholder:"ä¾‹å¦‚ï¼šå‡±å©·"},null,512),[[a.Jo,r.form.name,void 0,{trim:!0}]])]),(0,i.Lk)("div",Mt,[e[7]||(e[7]=(0,i.Lk)("label",{class:"form-label"},"å¸³è™Ÿ",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.account=t),class:"form-control",placeholder:"è«‹è¼¸å…¥å¸³è™Ÿ"},null,512),[[a.Jo,r.form.account,void 0,{trim:!0}]])]),(0,i.Lk)("div",Nt,[e[8]||(e[8]=(0,i.Lk)("label",{class:"form-label"},"å¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.form.password=t),type:"password",class:"form-control",placeholder:"è«‹è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,r.form.password,void 0,{trim:!0}]])]),(0,i.Lk)("div",$t,[e[9]||(e[9]=(0,i.Lk)("label",{class:"form-label"},"ç¢ºèªå¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.form.password2=t),type:"password",class:"form-control",placeholder:"å†æ¬¡è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,r.form.password2,void 0,{trim:!0}]])]),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:e[4]||(e[4]=(...t)=>o.submit&&o.submit(...t))}," å»ºç«‹å¸³è™Ÿï¼ˆæ‰“ç‰ˆï¼‰ "),r.msg?((0,i.uX)(),(0,i.CE)("div",At,(0,n.v_)(r.msg),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",Ft,[e[10]||(e[10]=(0,i.eW)(" å·²æœ‰å¸³è™Ÿï¼Ÿ ",-1)),(0,i.Lk)("a",{href:"#",onClick:e[5]||(e[5]=(0,a.D$)(e=>t.$router.push("/"),["prevent"]))},"å›žé¦–é ç™»å…¥")]),e[12]||(e[12]=(0,i.Lk)("div",{class:"alert alert-warning mt-3 py-2 mb-0"}," ç›®å‰æ˜¯æ‰“ç‰ˆï¼šè¨»å†Šè³‡æ–™å…ˆå­˜ localStorageï¼ˆä¹‹å¾Œæ”¹æŽ¥ MySQLï¼‰ã€‚ ",-1))])])])])}s(8111),s(3579);var Qt={name:"RegisterView",data(){return{form:{name:"",account:"",password:"",password2:""},msg:""}},methods:{submit(){if(this.msg="",!this.form.name||!this.form.account||!this.form.password)return void(this.msg="è«‹å¡«å¯«å®Œæ•´è³‡æ–™");if(this.form.password!==this.form.password2)return void(this.msg="å…©æ¬¡å¯†ç¢¼ä¸ä¸€è‡´");const t=JSON.parse(localStorage.getItem("mock_users")||"[]");t.some(t=>t.account===this.form.account)?this.msg="æ­¤å¸³è™Ÿå·²å­˜åœ¨":(t.push({id:Date.now(),role:"buyer",name:this.form.name,account:this.form.account}),localStorage.setItem("mock_users",JSON.stringify(t)),this.msg="è¨»å†ŠæˆåŠŸï¼ä½ å¯ä»¥å›žé¦–é ç”¨ admin/1234 æˆ– user/1234 æ¸¬è©¦ç™»å…¥æµç¨‹ï¼ˆä¹‹å¾Œæœƒæ”¹æˆçœŸæ­£ç™»å…¥ï¼‰")}}};const Ut=(0,z.A)(Qt,[["render",Ot]]);var Vt=Ut;const Jt={class:"card shadow-sm"};function Rt(t,e,s,a,n,l){return(0,i.uX)(),(0,i.CE)("div",Jt,[...e[0]||(e[0]=[(0,i.Lk)("div",{class:"card-body p-4"},[(0,i.Lk)("h2",{class:"h4 fw-bold mb-2"},"æœ€æ–°æ¶ˆæ¯ï¼ˆæ›´å¤šï¼‰"),(0,i.Lk)("p",{class:"text-muted mb-0"},"å…ˆåšæ‰“ç‰ˆï¼šä¹‹å¾Œå¯æŽ¥ /mock-db/news.jsonã€‚")],-1)])])}var Kt={name:"NewsListView"};const Bt=(0,z.A)(Kt,[["render",Rt]]);var Ht=Bt;const qt={class:"container py-4"},Gt={class:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3"},Wt={class:"h4 fw-bold mb-1"},Yt={key:0},Zt={key:1},te={key:2},ee={class:"text-muted small"},se={class:"d-flex gap-2 flex-wrap"},ae={class:"card shadow-sm mb-3"},ie={class:"card-body"},ne={class:"row g-2 align-items-center"},le={class:"col-12 col-md-6"},re={class:"col-12 col-md-3"},oe=["value"],de={class:"col-12 col-md-3 d-flex gap-2"},ce={class:"mt-3 d-flex flex-wrap gap-2"},me=["onClick"],ue={key:0,class:"text-muted"},he={key:1,class:"alert alert-danger"},ke={key:2},be={key:0,class:"alert alert-light border"},ge={class:"row g-3"},pe=["onClick"],ve=["src","alt"],fe={class:"card-body"},we={class:"d-flex justify-content-between align-items-start gap-2"},Le={class:"h6 fw-bold mb-1"},ye={class:"badge text-bg-danger"},Ce={class:"small text-muted mb-2"},_e={class:"me-2"},xe={class:"me-2"},Ee={class:"card-text text-muted small clamp-2"},Se={class:"d-flex flex-wrap gap-2 mt-2"},Xe=["onClick"],Pe={class:"card-footer bg-white border-0 pt-0"},De={class:"d-flex justify-content-between align-items-center"},ze={class:"small text-muted"},Ie={key:0},je={class:"mt-4 text-center"};function Te(t,e,s,l,r,o){const d=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",qt,[(0,i.Lk)("div",Gt,[(0,i.Lk)("div",null,[(0,i.Lk)("h1",Wt,["hot"===o.mode?((0,i.uX)(),(0,i.CE)("span",Yt,"æœ€ç†±é–€")):"latest"===o.mode?((0,i.uX)(),(0,i.CE)("span",Zt,"æœ€æ–°ä¸Šæž¶")):((0,i.uX)(),(0,i.CE)("span",te,"ä¸€ç•ªè³žæ¸…å–®"))]),(0,i.Lk)("div",ee," ç›®å‰å…± "+(0,n.v_)(o.filtered.length)+" å¥—ï¼ˆè³‡æ–™ï¼š/mock-db/gachas.jsonï¼‰ ",1)]),(0,i.Lk)("div",se,[(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:e[0]||(e[0]=t=>o.setMode("hot"))},"æœ€ç†±é–€"),(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:e[1]||(e[1]=t=>o.setMode("latest"))},"æœ€æ–°ä¸Šæž¶"),(0,i.bF)(d,{to:"/",class:"btn btn-outline-secondary btn-sm"},{default:(0,i.k6)(()=>[...e[6]||(e[6]=[(0,i.eW)("å›žé¦–é ",-1)])]),_:1})])]),(0,i.Lk)("div",ae,[(0,i.Lk)("div",ie,[(0,i.Lk)("div",ne,[(0,i.Lk)("div",le,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.q=t),class:"form-control",placeholder:"æœå°‹ï¼šåç¨± / code / tagï¼ˆä¾‹å¦‚ èˆªæµ·çŽ‹ã€DEMO-001ï¼‰"},null,512),[[a.Jo,r.q,void 0,{trim:!0}]])]),(0,i.Lk)("div",re,[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.tag=t),class:"form-select"},[e[7]||(e[7]=(0,i.Lk)("option",{value:""},"å…¨éƒ¨æ¨™ç±¤",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.allTags,t=>((0,i.uX)(),(0,i.CE)("option",{key:t,value:t},(0,n.v_)(t),9,oe))),128))],512),[[a.u1,r.tag]])]),(0,i.Lk)("div",de,[(0,i.Lk)("button",{class:"btn btn-outline-secondary w-100",onClick:e[4]||(e[4]=(...t)=>o.resetFilters&&o.resetFilters(...t))}," æ¸…é™¤ "),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:e[5]||(e[5]=(...t)=>o.scrollTop&&o.scrollTop(...t))}," å›žé ‚éƒ¨ ")])]),(0,i.Lk)("div",ce,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.allTags.slice(0,12),t=>((0,i.uX)(),(0,i.CE)("button",{key:t,class:(0,n.C4)(["btn btn-sm",r.tag===t?"btn-danger":"btn-outline-danger"]),onClick:e=>r.tag=r.tag===t?"":t}," #"+(0,n.v_)(t),11,me))),128))])])]),r.loading?((0,i.uX)(),(0,i.CE)("div",ue,"è®€å–ä¸­â€¦")):r.error?((0,i.uX)(),(0,i.CE)("div",he,"è¼‰å…¥å¤±æ•—ï¼š"+(0,n.v_)(r.error),1)):((0,i.uX)(),(0,i.CE)("div",ke,[0===o.filtered.length?((0,i.uX)(),(0,i.CE)("div",be," æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ã€‚ ")):(0,i.Q3)("",!0),(0,i.Lk)("div",ge,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.filtered,t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:e=>o.goDetail(t)},[(0,i.Lk)("img",{src:t.image_url,class:"card-img-top",alt:t.name,style:{height:"180px","object-fit":"cover"}},null,8,ve),(0,i.Lk)("div",fe,[(0,i.Lk)("div",we,[(0,i.Lk)("h3",Le,(0,n.v_)(t.name),1),(0,i.Lk)("span",ye,"å–®æŠ½ "+(0,n.v_)(t.price),1)]),(0,i.Lk)("div",Ce,[(0,i.Lk)("span",_e,"â¤ "+(0,n.v_)(t.like_count??0),1),(0,i.Lk)("span",xe,"Â· é»žæ“Š "+(0,n.v_)(t.show_n??0),1),(0,i.Lk)("span",null,"Â· ä¸€èˆ¬æŠ½ "+(0,n.v_)(t.total_draws??"-"),1)]),(0,i.Lk)("p",Ee,(0,n.v_)(t.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1),(0,i.Lk)("div",Se,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.tags||[],t=>((0,i.uX)(),(0,i.CE)("span",{key:t,class:"badge text-bg-light border",onClick:(0,a.D$)(e=>r.tag=t,["stop"]),style:{cursor:"pointer"},title:"é»žæˆ‘ç”¨æ­¤æ¨™ç±¤ç¯©é¸"}," #"+(0,n.v_)(t),9,Xe))),128))])]),(0,i.Lk)("div",Pe,[(0,i.Lk)("div",De,[(0,i.Lk)("span",ze,[t.code?((0,i.uX)(),(0,i.CE)("span",Ie,"ä»£ç¢¼ï¼š"+(0,n.v_)(t.code),1)):(0,i.Q3)("",!0)]),e[8]||(e[8]=(0,i.Lk)("span",{class:"btn btn-sm btn-outline-danger"},"é€²å…¥æŠ½çŽ â†’",-1))])])],8,pe)]))),128))]),(0,i.Lk)("div",je,[(0,i.bF)(d,{to:"/",class:"btn btn-outline-secondary"},{default:(0,i.k6)(()=>[...e[9]||(e[9]=[(0,i.eW)("å›žé¦–é ",-1)])]),_:1})])]))])}s(2489),s(7588),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);var Me={name:"SeriesListView",data(){return{loading:!0,error:null,gachas:[],q:"",tag:""}},computed:{mode(){return this.$route.query.mode||""},allTags(){const t=new Set;for(const e of this.gachas)(e.tags||[]).forEach(e=>t.add(e));return Array.from(t).sort((t,e)=>t.localeCompare(e,"zh-Hant"))},sorted(){const t=[...this.gachas];return"hot"===this.mode?t.sort((t,e)=>{const s=(t.show_n||0)+(t.like_count||0),a=(e.show_n||0)+(e.like_count||0);return a-s}):"latest"===this.mode?t.sort((t,e)=>{const s=t.created_at?Date.parse(t.created_at):t.id||0,a=e.created_at?Date.parse(e.created_at):e.id||0;return a-s}):t.sort((t,e)=>(t.id||0)-(e.id||0)),t},filtered(){const t=(this.q||"").toLowerCase(),e=this.tag;return this.sorted.filter(s=>{const a=[s.name,s.code,...s.tags||[]].filter(Boolean).join(" ").toLowerCase(),i=!t||a.includes(t),n=!e||(s.tags||[]).includes(e);return i&&n})}},watch:{"$route.query.mode"(){this.scrollTop()}},async mounted(){try{const t=await fetch("/mock-db/gachas.json");if(!t.ok)throw new Error("gachas.json HTTP "+t.status);const e=await t.json();this.gachas=Array.isArray(e)?e:e.items||[]}catch(t){this.error=t.message||String(t)}finally{this.loading=!1}},methods:{setMode(t){this.$router.push({path:"/series",query:{mode:t}})},resetFilters(){this.q="",this.tag=""},scrollTop(){window.scrollTo({top:0,behavior:"smooth"})},goDetail(t){this.$router.push(`/series/${t.id}`)}}};const Ne=(0,z.A)(Me,[["render",Te],["__scopeId","data-v-0fbda55e"]]);var $e=Ne;const Ae={class:"card shadow-sm"};function Fe(t,e,s,a,n,l){return(0,i.uX)(),(0,i.CE)("div",Ae,[...e[0]||(e[0]=[(0,i.Lk)("div",{class:"card-body p-4"},[(0,i.Lk)("h2",{class:"h4 fw-bold mb-2"},"ç®¡ç†ä¸€ç•ªè³ž"),(0,i.Lk)("p",{class:"text-muted mb-0"}," å…ˆåšæ‰“ç‰ˆï¼šæ–°å¢ž / ä¿®æ”¹ / ä¸‹æž¶ï¼ˆä¹‹å¾ŒæŽ¥ MySQLï¼‰ã€‚ ")],-1)])])}var Oe={name:"AdminSeriesView"};const Qe=(0,z.A)(Oe,[["render",Fe]]);var Ue=Qe;const Ve={class:"container py-4"},Je={key:0,class:"text-muted"},Re={key:1,class:"alert alert-danger"},Ke={key:2,class:"row g-4"},Be={class:"col-12 col-lg-8"},He={class:"d-flex justify-content-between align-items-start gap-3 flex-wrap"},qe={class:"fw-bold mb-1"},Ge={class:"text-muted small"},We={class:"ms-2"},Ye={class:"card shadow-sm mt-3"},Ze={class:"card-body text-center"},ts={class:"fw-semibold mb-2"},es=["src","alt"],ss={key:0,class:"text-muted small mt-2"},as={class:"d-flex justify-content-center gap-2 mt-3"},is={class:"d-flex justify-content-end mt-3"},ns=["disabled"],ls={class:"mt-3 text-muted",style:{"white-space":"pre-line"}},rs={class:"col-12 col-lg-4"},os={class:"card shadow-sm"},ds={class:"card-body"},cs={class:"list-group"},ms={class:"d-flex justify-content-between align-items-center"},us={class:"me-2"},hs=["onClick"],ks={class:"d-flex justify-content-between align-items-center"},bs={class:"me-2"},gs={class:"ms-2"},ps={class:"badge text-bg-light border"},vs={class:"modal fade",ref:"drawModalEl",tabindex:"-1"},fs={class:"modal-dialog modal-dialog-centered modal-lg"},ws={class:"modal-content rounded-4"},Ls={class:"modal-header"},ys={class:"modal-title fw-bold"},Cs={key:0},_s={key:1},xs={class:"modal-body"},Es={key:0},Ss={class:"d-flex gap-2 flex-wrap"},Xs=["disabled"],Ps=["disabled"],Ds=["disabled"],zs={class:"small text-muted align-self-center ms-2"},Is={key:0,class:"alert alert-warning mt-3 mb-0"},js={key:1},Ts={class:"d-flex justify-content-between align-items-center flex-wrap gap-2"},Ms={class:"small text-muted"},Ns={class:"ticket-grid mt-3"},$s=["disabled","onClick"],As={class:"mt-2 small text-muted"},Fs={class:"d-flex justify-content-end mt-3"},Os=["disabled"],Qs={key:3,class:"anim-overlay"},Us={class:"anim-card"},Vs={class:"fw-bold mb-2"},Js={key:0},Rs={key:1},Ks={key:2},Bs={class:"mb-3 text-muted small"},Hs={key:0},qs={key:1},Gs={class:"anim-imgwrap"},Ws=["src","alt"],Ys={key:1,class:"anim-placeholder"},Zs={class:"modal fade",ref:"resultModalEl",tabindex:"-1"},ta={class:"modal-dialog modal-dialog-centered modal-lg"},ea={class:"modal-content rounded-4"},sa={class:"modal-body"},aa={key:0,class:"text-muted"},ia={key:1,class:"row g-3"},na={class:"border rounded-4 p-3 h-100"},la={class:"fw-bold mb-1"},ra={key:0},oa={key:1},da={key:2,class:"text-muted ms-2"},ca={class:"mb-2"},ma=["src"],ua={class:"modal-footer"},ha=["disabled"];function ka(t,e,s,a,l,r){const o=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",Ve,[l.loading?((0,i.uX)(),(0,i.CE)("div",Je,"è®€å–ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",Re,"è¼‰å…¥å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",Ke,[(0,i.Lk)("div",Be,[(0,i.Lk)("div",He,[(0,i.Lk)("div",null,[(0,i.Lk)("h1",qe,(0,n.v_)(l.series.name),1),(0,i.Lk)("div",Ge,[(0,i.eW)(" å–®æŠ½ "+(0,n.v_)(l.series.price)+" å…ƒ ï½œ ä¸€èˆ¬æŠ½ï¼šå‰©é¤˜ "+(0,n.v_)(r.remainingDraws)+" / "+(0,n.v_)(l.series.total_draws)+" ",1),(0,i.Lk)("span",We,"ï½œ æœ€å¾Œè³žï¼š"+(0,n.v_)(l.lastPrizeClaimed?"å·²é–‹å‡º":"æœªé–‹å‡º"),1)])])]),(0,i.Lk)("div",Ye,[(0,i.Lk)("div",Ze,[(0,i.Lk)("div",ts,(0,n.v_)(r.currentSlide.title),1),(0,i.Lk)("img",{src:r.currentSlide.image_url,alt:r.currentSlide.title,class:"img-fluid rounded-4 border",style:{"max-height":"420px",width:"100%","object-fit":"cover"}},null,8,es),r.currentSlide.description?((0,i.uX)(),(0,i.CE)("div",ss,(0,n.v_)(r.currentSlide.description),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",as,[(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:e[0]||(e[0]=(...t)=>r.prevSlide&&r.prevSlide(...t))},"ä¸Šä¸€å¼µ"),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:e[1]||(e[1]=(...t)=>r.nextSlide&&r.nextSlide(...t))},"ä¸‹ä¸€å¼µ")])])]),(0,i.Lk)("div",is,[(0,i.Lk)("button",{class:"btn btn-danger px-4",onClick:e[2]||(e[2]=(...t)=>r.openDrawModal&&r.openDrawModal(...t)),disabled:r.remainingDraws<=0&&l.lastPrizeClaimed}," æŠ½çŽ ",8,ns)]),(0,i.Lk)("p",ls,(0,n.v_)(l.series.description),1),(0,i.bF)(o,{to:"/",class:"btn btn-link px-0"},{default:(0,i.k6)(()=>[...e[12]||(e[12]=[(0,i.eW)("â† å›žé¦–é ",-1)])]),_:1})]),(0,i.Lk)("div",rs,[(0,i.Lk)("div",os,[(0,i.Lk)("div",ds,[e[14]||(e[14]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-3"},"çŽé …æ¸…å–®",-1)),(0,i.Lk)("div",cs,[r.lastPrize?((0,i.uX)(),(0,i.CE)("button",{key:0,class:(0,n.C4)(["list-group-item last-prize-item",{claimed:l.lastPrizeClaimed}]),onClick:e[3]||(e[3]=t=>r.goToPrizeSlide(r.lastPrize))},[(0,i.Lk)("div",ms,[(0,i.Lk)("div",us,[e[13]||(e[13]=(0,i.Lk)("strong",{class:"me-2"},"æœ€å¾Œè³ž",-1)),(0,i.Lk)("span",null,(0,n.v_)(r.lastPrize.name),1)]),(0,i.Lk)("span",{class:(0,n.C4)(["badge",l.lastPrizeClaimed?"text-bg-secondary":"text-bg-warning"])},(0,n.v_)(l.lastPrizeClaimed?"å·²é–‹å‡º":"æœªé–‹å‡º"),3)])],2)):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.normalPrizesSorted,t=>((0,i.uX)(),(0,i.CE)("button",{key:t.id,class:(0,n.C4)(["list-group-item list-group-item-action",{"soldout-item":t.remaining<=0}]),onClick:e=>r.goToPrizeSlide(t)},[(0,i.Lk)("div",ks,[(0,i.Lk)("div",bs,[(0,i.Lk)("strong",null,(0,n.v_)(t.tier)+"è³ž",1),(0,i.Lk)("span",gs,(0,n.v_)(t.name),1)]),(0,i.Lk)("span",ps,(0,n.v_)(t.remaining)+" / "+(0,n.v_)(t.total),1)])],10,hs))),128))]),e[15]||(e[15]=(0,i.Lk)("div",{class:"small text-muted mt-3"}," â€» ä¸€èˆ¬æŠ½æ•¸ç”¨ç›¡æ™‚ï¼Œæœ€å¾Œè³žæœƒã€Œéš¨æœ€å¾Œä¸€è¼ªæŠ½çŽä¸€èµ·ç™¼æ”¾ã€ ",-1))])])])])),(0,i.Lk)("div",vs,[(0,i.Lk)("div",fs,[(0,i.Lk)("div",ws,[(0,i.Lk)("div",Ls,[(0,i.Lk)("h5",ys,["chooseCount"===l.drawStage?((0,i.uX)(),(0,i.CE)("span",Cs,"é¸æ“‡æŠ½çŽæ–¹å¼")):((0,i.uX)(),(0,i.CE)("span",_s,"é¸æ“‡è™Ÿç¢¼ï¼ˆ"+(0,n.v_)(l.drawCount)+" æŠ½ï¼‰",1))]),(0,i.Lk)("button",{class:"btn-close","data-bs-dismiss":"modal",onClick:e[4]||(e[4]=(...t)=>r.resetDrawFlow&&r.resetDrawFlow(...t))})]),(0,i.Lk)("div",xs,["chooseCount"===l.drawStage?((0,i.uX)(),(0,i.CE)("div",Es,[(0,i.Lk)("div",Ss,[(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:e[5]||(e[5]=t=>r.startPick(1)),disabled:r.remainingDraws<1}," å–®æŠ½ ",8,Xs),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:e[6]||(e[6]=t=>r.startPick(5)),disabled:r.remainingDraws<5}," äº”æŠ½ ",8,Ps),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:e[7]||(e[7]=t=>r.startPick(10)),disabled:r.remainingDraws<10}," åæŠ½ ",8,Ds),(0,i.Lk)("div",zs," ï¼ˆå‰©é¤˜ä¸€èˆ¬æŠ½ï¼š"+(0,n.v_)(r.remainingDraws)+"ï¼‰ ",1)]),0===r.remainingDraws?((0,i.uX)(),(0,i.CE)("div",Is," ä¸€èˆ¬æŠ½å·²æŠ½å®Œï¼›æœ€å¾Œè³žæœƒåœ¨ä½ æœ€å¾Œä¸€æ¬¡æŠ½çŽæ™‚ä¸€èµ·ç™¼æ”¾ï¼ˆè‹¥å°šæœªé ˜å–ï¼‰ã€‚ ")):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",js,[(0,i.Lk)("div",Ts,[(0,i.Lk)("div",Ms," é»žé¸è™Ÿç¢¼å¯éŽ–å®šï¼ˆæœ€å¤š "+(0,n.v_)(l.drawCount)+" å€‹ï¼‰ï¼›å·²æŠ½éŽæœƒæ˜¯ç°è‰²ä¸å¯é¸ ",1),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e[8]||(e[8]=(...t)=>r.systemPick&&r.systemPick(...t))}," ç³»çµ±å¹«æŠ½ ")]),(0,i.Lk)("div",Ns,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.series.total_draws,t=>((0,i.uX)(),(0,i.CE)("button",{key:t,type:"button",class:(0,n.C4)(["ticket",{drawn:r.isDrawn(t),selected:l.pickedNumbers.includes(t)&&!r.isDrawn(t)}]),disabled:r.isDrawn(t),onClick:e=>r.togglePickNumber(t)},(0,n.v_)(t),11,$s))),128))]),(0,i.Lk)("div",As,[e[16]||(e[16]=(0,i.eW)(" å·²é¸ï¼š",-1)),(0,i.Lk)("strong",null,(0,n.v_)(l.pickedNumbers.length),1),(0,i.eW)(" / "+(0,n.v_)(l.drawCount),1)]),(0,i.Lk)("div",Fs,[(0,i.Lk)("button",{class:"btn btn-danger",onClick:e[9]||(e[9]=(...t)=>r.confirmDraw&&r.confirmDraw(...t)),disabled:l.pickedNumbers.length!==l.drawCount}," ç¢ºèªæŠ½çŽ ",8,Os)])]))])])])],512),l.anim.show?((0,i.uX)(),(0,i.CE)("div",Qs,[(0,i.Lk)("button",{class:"skip-btn",onClick:e[10]||(e[10]=(...t)=>r.skipAnimation&&r.skipAnimation(...t))},"SKIP"),(0,i.Lk)("div",Us,[e[17]||(e[17]=(0,i.Lk)("div",{class:"small text-muted mb-2"},"æŠ½çŽä¸­â€¦",-1)),(0,i.Lk)("div",Vs,[l.anim.current&&l.anim.current.isLastPrize?((0,i.uX)(),(0,i.CE)("span",Js,"æœ€å¾Œè³ž")):l.anim.current?((0,i.uX)(),(0,i.CE)("span",Rs,(0,n.v_)(l.anim.current.tier)+"è³ž",1)):((0,i.uX)(),(0,i.CE)("span",Ks,"---"))]),(0,i.Lk)("div",Bs,[l.anim.current?((0,i.uX)(),(0,i.CE)("span",Hs,(0,n.v_)(l.anim.current.name),1)):((0,i.uX)(),(0,i.CE)("span",qs,"æ­£åœ¨è½‰å‹•â€¦"))]),(0,i.Lk)("div",Gs,[l.anim.current&&l.anim.current.image_url?((0,i.uX)(),(0,i.CE)("img",{key:0,src:l.anim.current.image_url,class:"anim-img",alt:l.anim.current.name},null,8,Ws)):((0,i.uX)(),(0,i.CE)("div",Ys,"ðŸŽ²"))])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Zs,[(0,i.Lk)("div",ta,[(0,i.Lk)("div",ea,[e[19]||(e[19]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title fw-bold"},"ðŸŽ‰ æŠ½çŽçµæžœ"),(0,i.Lk)("button",{class:"btn-close","data-bs-dismiss":"modal"})],-1)),(0,i.Lk)("div",sa,[0===l.drawResults.length?((0,i.uX)(),(0,i.CE)("div",aa,"ï¼ˆæ²’æœ‰çµæžœï¼‰")):((0,i.uX)(),(0,i.CE)("div",ia,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.drawResults,(t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:e,class:"col-12 col-md-6"},[(0,i.Lk)("div",na,[(0,i.Lk)("div",la,[t.isLastPrize?((0,i.uX)(),(0,i.CE)("span",ra,"æœ€å¾Œè³ž")):((0,i.uX)(),(0,i.CE)("span",oa,(0,n.v_)(t.tier)+"è³ž",1)),t.isLastPrize?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("span",da,"ï¼ˆè™Ÿç¢¼ "+(0,n.v_)(t.number)+"ï¼‰",1))]),(0,i.Lk)("div",ca,(0,n.v_)(t.name),1),(0,i.Lk)("img",{src:t.image_url,class:"img-fluid rounded-4 border",style:{"max-height":"260px",width:"100%","object-fit":"cover"}},null,8,ma)])]))),128))]))]),(0,i.Lk)("div",ua,[e[18]||(e[18]=(0,i.Lk)("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"é—œé–‰",-1)),(0,i.Lk)("button",{class:"btn btn-danger",onClick:e[11]||(e[11]=(...t)=>r.againDraw&&r.againDraw(...t)),disabled:r.remainingDraws<=0&&l.lastPrizeClaimed}," å†æŠ½ä¸€æ¬¡ ",8,ha)])])])],512)])}s(116),s(1701),s(8237);var ba={name:"SeriesDetailView",data(){return{loading:!0,error:null,series:null,prizes:[],ticketPrizeIds:[],initialDrawnSet:new Set,drawnSet:new Set,drawStage:"chooseCount",drawCount:1,pickedNumbers:[],lastPrizeClaimed:!1,drawResults:[],slides:[],currentSlideIndex:0,anim:{show:!1,current:null,_timer:null,_endTimer:null,_pendingResults:null}}},computed:{seriesId(){return Number(this.$route.params.id)},lastPrize(){return this.prizes.find(t=>String(t.tier).includes("æœ€å¾Œ"))||null},normalPrizes(){return this.prizes.filter(t=>!String(t.tier).includes("æœ€å¾Œ"))},normalPrizesSorted(){const t=["A","B","C","D","E","F","G","H","I","J","K"],e=e=>{const s=t.indexOf(String(e||"").toUpperCase());return-1===s?999:s};return[...this.normalPrizes].sort((t,s)=>e(t.tier)-e(s.tier))},remainingDraws(){return this.normalPrizesSorted.reduce((t,e)=>t+Number(e.remaining||0),0)},currentSlide(){return this.slides[this.currentSlideIndex]||{title:"-",image_url:"",description:""}}},async mounted(){try{const t=await fetch("/mock-db/gachas.json"),e=await fetch("/mock-db/prizes.json");if(!t.ok)throw new Error("gachas.json HTTP "+t.status);if(!e.ok)throw new Error("prizes.json HTTP "+e.status);const s=await t.json(),a=await e.json(),i=s.find(t=>Number(t.id)===this.seriesId)||null;if(!i)throw new Error(`æ‰¾ä¸åˆ° gachas.json ä¸­ id=${this.seriesId} çš„ä¸€ç•ªè³ž`);this.series=i,this.prizes=a.filter(t=>Number(t.gacha_id)===this.seriesId).map(t=>({...t,isLastPrize:String(t.tier).includes("æœ€å¾Œ")})),this.buildTicketMap(),this.buildSlides(),this.currentSlideIndex=0}catch(t){this.error=t.message||String(t)}finally{this.loading=!1}},methods:{openDrawModal(){this.resetDrawFlow();const t=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.drawModalEl);t?.show()},resetDrawFlow(){this.drawStage="chooseCount",this.drawCount=1,this.pickedNumbers=[]},startPick(t){this.drawCount=t,this.pickedNumbers=[],this.drawStage="pickNumbers"},systemPick(){const t=[],e=Number(this.series?.total_draws||0);for(let s=1;s<=e;s++)this.isDrawn(s)||t.push(s);this.shuffle(t),this.pickedNumbers=t.slice(0,this.drawCount).sort((t,e)=>t-e)},togglePickNumber(t){if(this.isDrawn(t))return;const e=this.pickedNumbers.indexOf(t);e>=0?this.pickedNumbers.splice(e,1):this.pickedNumbers.length>=this.drawCount||(this.pickedNumbers.push(t),this.pickedNumbers.sort((t,e)=>t-e))},confirmDraw(){if(this.pickedNumbers.length!==this.drawCount)return;const t=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.drawModalEl);t?.hide();const e=[];for(const s of this.pickedNumbers){if(this.isDrawn(s))continue;this.drawnSet.add(s);const t=this.ticketPrizeIds[s-1],a=this.prizes.find(e=>e.id===t),i=a||null;i&&!i.isLastPrize&&Number(i.remaining)>0&&(i.remaining-=1),e.push({number:s,tier:i?.tier||"?",name:i?.name||"ï¼ˆæœªçŸ¥çŽé …ï¼šè³‡æ–™ç¼ºæ¼ï¼‰",image_url:i?.image_url||"",isLastPrize:!1}),i&&this.goToPrizeSlide(i)}if(0===this.remainingDraws&&!this.lastPrizeClaimed&&this.lastPrize){this.lastPrizeClaimed=!0;const t=this.lastPrize;e.push({number:null,tier:t.tier,name:t.name,image_url:t.image_url,isLastPrize:!0}),this.goToPrizeSlide(t)}this.pickedNumbers=[],this.drawStage="chooseCount",this.startAnimation(e)},startAnimation(t){this.stopAnimationTimers();const e=[],s=this.normalPrizesSorted.filter(t=>t.image_url);for(let i=0;i<12;i++){const t=s[Math.floor(Math.random()*s.length)];t&&e.push({tier:t.tier,name:t.name,image_url:t.image_url,isLastPrize:!1})}for(const i of t)e.push(i);this.anim.show=!0,this.anim._pendingResults=t,this.anim.current=e[0]||null;let a=0;this.anim._timer=setInterval(()=>{a=(a+1)%e.length,this.anim.current=e[a]},80),this.anim._endTimer=setTimeout(()=>{this.finishAnimation()},1200)},skipAnimation(){this.finishAnimation()},finishAnimation(){this.anim.show&&(this.stopAnimationTimers(),this.anim.show=!1,this.anim.current=null,this.drawResults=this.anim._pendingResults||[],this.anim._pendingResults=null,this.openResultModal())},stopAnimationTimers(){this.anim._timer&&clearInterval(this.anim._timer),this.anim._endTimer&&clearTimeout(this.anim._endTimer),this.anim._timer=null,this.anim._endTimer=null},openResultModal(){const t=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.resultModalEl);t?.show()},againDraw(){const t=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.resultModalEl);t?.hide(),setTimeout(()=>this.openDrawModal(),150)},buildTicketMap(){const t=Number(this.series?.total_draws||0),e=[];for(const i of this.normalPrizesSorted){const t=Number(i.total||0);for(let s=0;s<t;s++)e.push(i.id)}if(e.length!==t){console.warn(`[è³‡æ–™ä¸ä¸€è‡´] prizes.totalç¸½å’Œ=${e.length}, gachas.total_draws=${t}`),e.length>t&&(e.length=t);while(e.length<t)e.push(null)}this.shuffle(e),this.ticketPrizeIds=e;const s={};for(const i of this.normalPrizesSorted)s[i.id]=Math.max(0,Number(i.total||0)-Number(i.remaining||0));const a=new Set;for(let i=0;i<this.ticketPrizeIds.length;i++){const t=this.ticketPrizeIds[i];t&&((s[t]||0)>0&&(a.add(i+1),s[t]-=1))}this.initialDrawnSet=a},buildSlides(){const t=[];this.series?.image_url&&t.push({type:"banner",title:"å®£å‚³åœ–",image_url:this.series.image_url,description:""});const e=[];this.lastPrize&&e.push(this.lastPrize),e.push(...this.normalPrizesSorted);for(const s of e)t.push({type:"prize",prizeId:s.id,title:`${s.isLastPrize?"æœ€å¾Œè³ž":s.tier+"è³ž"} ${s.name}`,image_url:s.image_url,description:s.description||""});this.slides=t},prevSlide(){this.slides.length&&(this.currentSlideIndex=(this.currentSlideIndex-1+this.slides.length)%this.slides.length)},nextSlide(){this.slides.length&&(this.currentSlideIndex=(this.currentSlideIndex+1)%this.slides.length)},goToPrizeSlide(t){const e=this.slides.findIndex(e=>"prize"===e.type&&e.prizeId===t.id);e>=0&&(this.currentSlideIndex=e)},isDrawn(t){return this.initialDrawnSet.has(t)||this.drawnSet.has(t)},shuffle(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}}},beforeUnmount(){this.stopAnimationTimers()}};const ga=(0,z.A)(ba,[["render",ka],["__scopeId","data-v-4b965f96"]]);var pa=ga;const va=[{path:"/",name:"home",component:Pt},{path:"/register",name:"register",component:Vt},{path:"/news",name:"news",component:Ht},{path:"/series",name:"series",component:$e},{path:"/series/:id",name:"seriesDetail",component:pa,props:!0},{path:"/admin/series",name:"adminSeries",component:Ue}];var fa=(0,T.aE)({history:(0,T.Bt)(),routes:va});(0,a.Ef)(j).use(fa).mount("#app")}},e={};function s(a){var i=e[a];if(void 0!==i)return i.exports;var n=e[a]={exports:{}};return t[a].call(n.exports,n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,a,i,n){if(!a){var l=1/0;for(c=0;c<t.length;c++){a=t[c][0],i=t[c][1],n=t[c][2];for(var r=!0,o=0;o<a.length;o++)(!1&n||l>=n)&&Object.keys(s.O).every(function(t){return s.O[t](a[o])})?a.splice(o--,1):(r=!1,n<l&&(l=n));if(r){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[a,i,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,n,l=a[0],r=a[1],o=a[2],d=0;if(l.some(function(e){return 0!==t[e]})){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(o)var c=o(s)}for(e&&e(a);d<l.length;d++)n=l[d],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(c)},a=self["webpackChunkichiban_gacha_json"]=self["webpackChunkichiban_gacha_json"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],function(){return s(2956)});a=s.O(a)})();
//# sourceMappingURL=app.0cbcb997.js.map