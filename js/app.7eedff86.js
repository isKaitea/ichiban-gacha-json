(function(){"use strict";var e={6922:function(e,t,s){var a=s(5130),i=s(6768),n=s(4232);const l={class:"navbar navbar-expand-lg bg-white border-bottom sticky-top"},r={class:"container"},o={class:"collapse navbar-collapse",id:"navMenu"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},c={class:"nav-item"},m={class:"nav-item"},u={class:"nav-item"},h={class:"nav-item"},k={key:0,class:"nav-item"},b={class:"d-flex gap-2"},g={key:0,class:"btn btn-outline-danger","data-bs-toggle":"modal","data-bs-target":"#loginModal"},p={key:1,class:"d-flex align-items-center gap-2"},v={class:"small text-muted"},w={key:0,class:"badge text-bg-primary ms-1"},f={class:"container py-4"},L={class:"modal fade",id:"loginModal",tabindex:"-1"},y={class:"modal-dialog modal-dialog-centered"},C={class:"modal-content"},_={class:"modal-body"},x={class:"mb-3"},E={class:"mb-3"},S={class:"mt-3 small text-muted d-flex justify-content-between"},X={key:0,class:"alert alert-danger mt-3 py-2 mb-0"};function P(e,t,s,P,D,z){const I=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("nav",l,[(0,i.Lk)("div",r,[(0,i.Lk)("a",{class:"navbar-brand fw-bold text-danger",href:"#",onClick:t[0]||(t[0]=(0,a.D$)((...e)=>z.goHome&&z.goHome(...e),["prevent"]))}," ä¸€ç•ªè³ž "),t[12]||(t[12]=(0,i.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navMenu"},[(0,i.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,i.Lk)("div",o,[(0,i.Lk)("ul",d,[(0,i.Lk)("li",c,[(0,i.Lk)("a",{class:"nav-link",href:"#news",onClick:t[1]||(t[1]=(0,a.D$)(e=>z.jumpTo("news"),["prevent"]))},"æœ€æ–°æ¶ˆæ¯")]),(0,i.Lk)("li",m,[(0,i.Lk)("a",{class:"nav-link",href:"#hot",onClick:t[2]||(t[2]=(0,a.D$)(e=>z.jumpTo("hot"),["prevent"]))},"æœ€ç†±é–€")]),(0,i.Lk)("li",u,[(0,i.Lk)("a",{class:"nav-link",href:"#latest",onClick:t[3]||(t[3]=(0,a.D$)(e=>z.jumpTo("latest"),["prevent"]))},"æœ€æ–°ä¸Šæž¶")]),(0,i.Lk)("li",h,[(0,i.Lk)("a",{class:"nav-link",href:"#about",onClick:t[4]||(t[4]=(0,a.D$)(e=>z.jumpTo("about"),["prevent"]))},"é—œæ–¼æˆ‘å€‘")]),z.isAdmin?((0,i.uX)(),(0,i.CE)("li",k,[(0,i.Lk)("a",{class:"nav-link fw-bold text-primary",href:"#",onClick:t[5]||(t[5]=(0,a.D$)((...e)=>z.goAdmin&&z.goAdmin(...e),["prevent"]))}," ç®¡ç†ä¸€ç•ªè³ž ")])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",b,[z.isLoggedIn?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("span",v,[(0,i.eW)(" å—¨ï¼Œ"+(0,n.v_)(D.user.name)+" ",1),z.isAdmin?((0,i.uX)(),(0,i.CE)("span",w,"Admin")):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[6]||(t[6]=(...e)=>z.logout&&z.logout(...e))},"ç™»å‡º")])):((0,i.uX)(),(0,i.CE)("button",g," ç™»å…¥ "))])])])]),(0,i.Lk)("main",f,[(0,i.bF)(I)]),(0,i.Lk)("div",L,[(0,i.Lk)("div",y,[(0,i.Lk)("div",C,[t[16]||(t[16]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title fw-bold"},"ç™»å…¥"),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),(0,i.Lk)("div",_,[(0,i.Lk)("div",x,[t[13]||(t[13]=(0,i.Lk)("label",{class:"form-label"},"å¸³è™Ÿ",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>D.loginForm.account=e),type:"text",class:"form-control",placeholder:"è¼¸å…¥å¸³è™Ÿ"},null,512),[[a.Jo,D.loginForm.account,void 0,{trim:!0}]])]),(0,i.Lk)("div",E,[t[14]||(t[14]=(0,i.Lk)("label",{class:"form-label"},"å¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>D.loginForm.password=e),type:"password",class:"form-control",placeholder:"è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,D.loginForm.password,void 0,{trim:!0}]])]),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:t[9]||(t[9]=(...e)=>z.submitLogin&&z.submitLogin(...e))},"ç™»å…¥"),(0,i.Lk)("div",S,[(0,i.Lk)("a",{href:"#",onClick:t[10]||(t[10]=(0,a.D$)((...e)=>z.forgotPassword&&z.forgotPassword(...e),["prevent"]))},"å¿˜è¨˜å¯†ç¢¼ï¼Ÿ"),(0,i.Lk)("a",{href:"#",onClick:t[11]||(t[11]=(0,a.D$)((...e)=>z.goRegister&&z.goRegister(...e),["prevent"]))},"è¨»å†Š")]),D.loginError?((0,i.uX)(),(0,i.CE)("div",X,(0,n.v_)(D.loginError),1)):(0,i.Q3)("",!0),t[15]||(t[15]=(0,i.Lk)("div",{class:"alert alert-warning mt-3 py-2 mb-0"}," æ‰“ç‰ˆç™»å…¥ï¼šadmin/1234ï¼ˆç®¡ç†è€…ï¼‰ã€user/1234ï¼ˆä¸€èˆ¬ï¼‰ ",-1))])])])])])}s(4114),s(3110),s(8335);var D={name:"App",data(){return{loginForm:{account:"",password:""},loginError:"",user:this.loadUser()}},computed:{isLoggedIn(){return!!this.user},isAdmin(){return"admin"===this.user?.role}},methods:{loadUser(){try{const e=localStorage.getItem("mock_user");return e?JSON.parse(e):null}catch{return null}},saveUser(e){this.user=e,localStorage.setItem("mock_user",JSON.stringify(e))},clearUser(){this.user=null,localStorage.removeItem("mock_user")},closeModalById(e){const t=document.getElementById(e);if(!t||!window.bootstrap)return;const s=window.bootstrap.Modal.getInstance(t)||new window.bootstrap.Modal(t);s.hide()},async jumpTo(e){"/"!==this.$route.path&&await this.$router.push("/"),this.$nextTick(()=>{const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})})},goHome(){this.$router.push("/")},goRegister(){this.closeModalById("loginModal"),this.$router.push("/register")},goAdmin(){this.$router.push("/admin/series")},forgotPassword(){alert("æ‰“ç‰ˆï¼šå¿˜è¨˜å¯†ç¢¼ä¹‹å¾Œå¯åš Email / OTP / é‡è¨­æµç¨‹ã€‚")},submitLogin(){this.loginError="";const e=this.loginForm.account,t=this.loginForm.password;if(("admin"===e||"user"===e)&&"1234"===t){const t={id:"admin"===e?1:2,name:"admin"===e?"ç®¡ç†è€…":"ä¸€èˆ¬ä½¿ç”¨è€…",role:"admin"===e?"admin":"buyer"};return this.saveUser(t),this.loginForm.account="",this.loginForm.password="",void this.closeModalById("loginModal")}this.loginError="å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼ˆæ‰“ç‰ˆï¼šadmin/1234 æˆ– user/1234ï¼‰"},logout(){this.clearUser(),alert("å·²ç™»å‡º")}}},z=s(1241);const I=(0,z.A)(D,[["render",P]]);var j=I,T=s(8728);const M={class:"p-4 p-md-5 mb-4 rounded-4 bg-white border shadow-sm"},$={class:"row align-items-center g-3"},N={class:"col-12 col-lg-8"},A={class:"d-flex gap-2 flex-wrap"},F={class:"col-12 col-lg-4"},O={class:"rounded-4 bg-light border p-3"},Q={key:0,class:"fw-bold"},U={key:1,class:"text-danger fw-bold"},V={key:2,class:"fw-bold"},R={id:"news",class:"mb-4"},J={class:"d-flex align-items-center justify-content-between mb-2"},B={class:"list-group shadow-sm"},K={class:"me-3"},H={class:"fw-semibold"},q={class:"small text-muted"},G={class:"badge text-bg-light border"},W={id:"hot",class:"mb-4"},Y={class:"d-flex align-items-center justify-content-between mb-2"},Z={key:0,class:"text-muted"},ee={key:1,class:"alert alert-danger py-2"},te={key:2,class:"row g-3"},se=["onClick"],ae=["src","alt"],ie={class:"card-body"},ne={class:"d-flex justify-content-between align-items-start gap-2"},le={class:"h6 fw-bold mb-1"},re={class:"badge text-bg-danger"},oe={class:"small text-muted mb-2"},de={class:"card-text text-muted small clamp-2"},ce={key:0,class:"text-muted"},me={id:"latest",class:"mb-4"},ue={class:"d-flex align-items-center justify-content-between mb-2"},he={key:0,class:"text-muted"},ke={key:1,class:"alert alert-danger py-2"},be={key:2,class:"row g-3"},ge=["onClick"],pe=["src","alt"],ve={class:"card-body"},we={class:"d-flex justify-content-between align-items-start gap-2"},fe={class:"h6 fw-bold mb-1"},Le={class:"badge text-bg-danger"},ye={class:"small text-muted mb-2"},Ce={key:0},_e={class:"card-text text-muted small clamp-2"},xe={key:0,class:"text-muted"};function Ee(e,t,s,a,l,r){return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",M,[(0,i.Lk)("div",$,[(0,i.Lk)("div",N,[t[6]||(t[6]=(0,i.Lk)("h1",{class:"fw-bold mb-2"},"ä¸€ç•ªè³žæŠ½çŽç¶²ç«™",-1)),t[7]||(t[7]=(0,i.Lk)("p",{class:"text-muted mb-3"}," ç›®å‰ä½¿ç”¨ JSON Mock DBï¼ˆpublic/mock-dbï¼‰ï¼Œä¹‹å¾ŒæœƒæŽ¥ Go + MySQLã€‚ ",-1)),(0,i.Lk)("div",A,[(0,i.Lk)("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=e=>r.scrollTo("hot"))},"çœ‹æœ€ç†±é–€"),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:t[1]||(t[1]=e=>r.scrollTo("latest"))},"çœ‹æœ€æ–°ä¸Šæž¶"),(0,i.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[2]||(t[2]=e=>r.scrollTo("news"))},"çœ‹æœ€æ–°æ¶ˆæ¯")])]),(0,i.Lk)("div",F,[(0,i.Lk)("div",O,[t[8]||(t[8]=(0,i.Lk)("div",{class:"small text-muted mb-1"},"ç‹€æ…‹",-1)),l.loading?((0,i.uX)(),(0,i.CE)("div",Q,"è®€å–ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",U,"è¼‰å…¥å¤±æ•—")):((0,i.uX)(),(0,i.CE)("div",V," å·²è¼‰å…¥ "+(0,n.v_)(l.gachas.length)+" å¥—ä¸€ç•ªè³ž ",1)),t[9]||(t[9]=(0,i.Lk)("div",{class:"small text-muted mt-2"}," æª”æ¡ˆï¼š/mock-db/gachas.json ",-1))])])])]),(0,i.Lk)("section",R,[(0,i.Lk)("div",J,[t[10]||(t[10]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€æ–°æ¶ˆæ¯",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[3]||(t[3]=(...e)=>r.goNews&&r.goNews(...e))},"æ›´å¤š")]),(0,i.Lk)("div",B,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.newsList,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-start"},[(0,i.Lk)("div",K,[(0,i.Lk)("div",H,(0,n.v_)(e.title),1),(0,i.Lk)("div",q,(0,n.v_)(e.desc),1)]),(0,i.Lk)("span",G,(0,n.v_)(e.date),1)]))),128))])]),(0,i.Lk)("section",W,[(0,i.Lk)("div",Y,[t[11]||(t[11]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€ç†±é–€",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[4]||(t[4]=e=>r.goSeriesList("hot"))},"æ›´å¤š")]),l.loading?((0,i.uX)(),(0,i.CE)("div",Z,"è¼‰å…¥ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",ee," è®€å–å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",te,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.hotGachas,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:t=>r.goSeriesDetail(e)},[(0,i.Lk)("img",{src:e.image_url,class:"card-img-top",alt:e.name,style:{height:"180px","object-fit":"cover"}},null,8,ae),(0,i.Lk)("div",ie,[(0,i.Lk)("div",ne,[(0,i.Lk)("h3",le,(0,n.v_)(e.name),1),(0,i.Lk)("span",re,"å–®æŠ½ "+(0,n.v_)(e.price),1)]),(0,i.Lk)("div",oe," â¤ "+(0,n.v_)(e.like_count||0)+" Â· é»žæ“Š "+(0,n.v_)(e.show_n||0),1),(0,i.Lk)("p",de,(0,n.v_)(e.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1)])],8,se)]))),128)),0===r.hotGachas.length?((0,i.uX)(),(0,i.CE)("div",ce,"ç›®å‰æ²’æœ‰è³‡æ–™")):(0,i.Q3)("",!0)]))]),(0,i.Lk)("section",me,[(0,i.Lk)("div",ue,[t[12]||(t[12]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-0"},"æœ€æ–°ä¸Šæž¶",-1)),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[5]||(t[5]=e=>r.goSeriesList("latest"))},"æ›´å¤š")]),l.loading?((0,i.uX)(),(0,i.CE)("div",he,"è¼‰å…¥ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",ke," è®€å–å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",be,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.latestGachas,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:t=>r.goSeriesDetail(e)},[(0,i.Lk)("img",{src:e.image_url,class:"card-img-top",alt:e.name,style:{height:"180px","object-fit":"cover"}},null,8,pe),(0,i.Lk)("div",ve,[(0,i.Lk)("div",we,[(0,i.Lk)("h3",fe,(0,n.v_)(e.name),1),(0,i.Lk)("span",Le,"å–®æŠ½ "+(0,n.v_)(e.price),1)]),(0,i.Lk)("div",ye,[(0,i.eW)(" ç¸½æŠ½æ•¸ "+(0,n.v_)(e.total_draws||"-")+" ",1),e.created_at?((0,i.uX)(),(0,i.CE)("span",Ce,"Â· "+(0,n.v_)(r.formatDate(e.created_at)),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("p",_e,(0,n.v_)(e.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1)])],8,ge)]))),128)),0===r.latestGachas.length?((0,i.uX)(),(0,i.CE)("div",xe,"ç›®å‰æ²’æœ‰è³‡æ–™")):(0,i.Q3)("",!0)]))]),t[13]||(t[13]=(0,i.Lk)("section",{id:"about",class:"mt-4"},[(0,i.Lk)("div",{class:"p-4 rounded-4 bg-white border shadow-sm"},[(0,i.Lk)("h2",{class:"h5 fw-bold mb-2"},"é—œæ–¼æˆ‘å€‘"),(0,i.Lk)("p",{class:"text-muted mb-0"}," é€™æ˜¯èª²å ‚/å°ˆé¡Œç”¨çš„ä¸€ç•ªè³žç¶²ç«™æ‰“ç‰ˆã€‚ç¾éšŽæ®µä½¿ç”¨ JSON Mock DBï¼Œ å¾ŒçºŒæœƒæŽ¥ Go API + MySQLï¼Œè®“æŠ½çŽã€åº«å­˜ã€æ”¶è—ã€ç®¡ç†åŠŸèƒ½æ›´å®Œæ•´ã€‚ ")])],-1))])}var Se={name:"HomeView",data(){return{loading:!0,error:null,gachas:[],newsList:[{id:1,date:"2025/12/15",title:"ã€å…¬å‘Šã€‘æœ¬é€±æ–°å¢žä¸€ç•ªè³žä¸Šæž¶ï¼",desc:"æ‰“ç‰ˆè³‡æ–™ï¼šä¹‹å¾Œå¯ç”±å¾Œå°æ–°å¢žã€‚"},{id:2,date:"2025/12/15",title:"ã€æ´»å‹•ã€‘æœƒå“¡æŠ½åé€ä¸€ï¼ˆç¤ºæ„ï¼‰",desc:"æ­£å¼ç‰ˆæœƒä¾æŠ½çŽç´€éŒ„è¨ˆç®—ã€‚"},{id:3,date:"2025/12/15",title:"ã€æé†’ã€‘æœ€å¾Œè³žåƒ…æœ€å¾Œä¸€æŠ½ç²å¾—",desc:"æŠ½çŽé‚è¼¯æœƒåœ¨è©³æƒ…é å¯¦ä½œã€‚"}]}},computed:{hotGachas(){const e=[...this.gachas];return e.sort((e,t)=>{const s=(e.show_n||0)+(e.like_count||0),a=(t.show_n||0)+(t.like_count||0);return a-s}),e.slice(0,6)},latestGachas(){const e=[...this.gachas];return e.sort((e,t)=>{const s=e.created_at?Date.parse(e.created_at):e.id,a=t.created_at?Date.parse(t.created_at):t.id;return a-s}),e.slice(0,6)}},async mounted(){try{const e=await fetch("mock-db/gachas.json");if(!e.ok)throw new Error("gachas.json HTTP "+e.status);const t=await e.json();this.gachas=Array.isArray(t)?t:t.items||[]}catch(e){this.error=e.message||String(e)}finally{this.loading=!1}},methods:{scrollTo(e){const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})},formatDate(e){try{const t=new Date(e);return`${t.getFullYear()}/${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}`}catch{return""}},goNews(){this.$router.push("/news")},goSeriesList(e){this.$router.push({path:"/series",query:{mode:e}})},goSeriesDetail(e){this.$router.push({name:"seriesDetail",params:{id:e.id}})}}};const Xe=(0,z.A)(Se,[["render",Ee],["__scopeId","data-v-5d4a49ec"]]);var Pe=Xe;const De={class:"row justify-content-center"},ze={class:"col-12 col-md-7 col-lg-5"},Ie={class:"card shadow-sm"},je={class:"card-body p-4"},Te={class:"mb-3"},Me={class:"mb-3"},$e={class:"mb-3"},Ne={class:"mb-3"},Ae={key:0,class:"alert alert-info mt-3 mb-0 py-2"},Fe={class:"mt-3 text-center small"};function Oe(e,t,s,l,r,o){return(0,i.uX)(),(0,i.CE)("div",De,[(0,i.Lk)("div",ze,[(0,i.Lk)("div",Ie,[(0,i.Lk)("div",je,[t[11]||(t[11]=(0,i.Lk)("h2",{class:"h4 fw-bold mb-3"},"è¨»å†Š",-1)),(0,i.Lk)("div",Te,[t[6]||(t[6]=(0,i.Lk)("label",{class:"form-label"},"é¡¯ç¤ºåç¨±",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.name=e),class:"form-control",placeholder:"ä¾‹å¦‚ï¼šå‡±å©·"},null,512),[[a.Jo,r.form.name,void 0,{trim:!0}]])]),(0,i.Lk)("div",Me,[t[7]||(t[7]=(0,i.Lk)("label",{class:"form-label"},"å¸³è™Ÿ",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.account=e),class:"form-control",placeholder:"è«‹è¼¸å…¥å¸³è™Ÿ"},null,512),[[a.Jo,r.form.account,void 0,{trim:!0}]])]),(0,i.Lk)("div",$e,[t[8]||(t[8]=(0,i.Lk)("label",{class:"form-label"},"å¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.password=e),type:"password",class:"form-control",placeholder:"è«‹è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,r.form.password,void 0,{trim:!0}]])]),(0,i.Lk)("div",Ne,[t[9]||(t[9]=(0,i.Lk)("label",{class:"form-label"},"ç¢ºèªå¯†ç¢¼",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.password2=e),type:"password",class:"form-control",placeholder:"å†æ¬¡è¼¸å…¥å¯†ç¢¼"},null,512),[[a.Jo,r.form.password2,void 0,{trim:!0}]])]),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:t[4]||(t[4]=(...e)=>o.submit&&o.submit(...e))}," å»ºç«‹å¸³è™Ÿï¼ˆæ‰“ç‰ˆï¼‰ "),r.msg?((0,i.uX)(),(0,i.CE)("div",Ae,(0,n.v_)(r.msg),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",Fe,[t[10]||(t[10]=(0,i.eW)(" å·²æœ‰å¸³è™Ÿï¼Ÿ ",-1)),(0,i.Lk)("a",{href:"#",onClick:t[5]||(t[5]=(0,a.D$)(t=>e.$router.push("/"),["prevent"]))},"å›žé¦–é ç™»å…¥")]),t[12]||(t[12]=(0,i.Lk)("div",{class:"alert alert-warning mt-3 py-2 mb-0"}," ç›®å‰æ˜¯æ‰“ç‰ˆï¼šè¨»å†Šè³‡æ–™å…ˆå­˜ localStorageï¼ˆä¹‹å¾Œæ”¹æŽ¥ MySQLï¼‰ã€‚ ",-1))])])])])}s(8111),s(3579);var Qe={name:"RegisterView",data(){return{form:{name:"",account:"",password:"",password2:""},msg:""}},methods:{submit(){if(this.msg="",!this.form.name||!this.form.account||!this.form.password)return void(this.msg="è«‹å¡«å¯«å®Œæ•´è³‡æ–™");if(this.form.password!==this.form.password2)return void(this.msg="å…©æ¬¡å¯†ç¢¼ä¸ä¸€è‡´");const e=JSON.parse(localStorage.getItem("mock_users")||"[]");e.some(e=>e.account===this.form.account)?this.msg="æ­¤å¸³è™Ÿå·²å­˜åœ¨":(e.push({id:Date.now(),role:"buyer",name:this.form.name,account:this.form.account}),localStorage.setItem("mock_users",JSON.stringify(e)),this.msg="è¨»å†ŠæˆåŠŸï¼ä½ å¯ä»¥å›žé¦–é ç”¨ admin/1234 æˆ– user/1234 æ¸¬è©¦ç™»å…¥æµç¨‹ï¼ˆä¹‹å¾Œæœƒæ”¹æˆçœŸæ­£ç™»å…¥ï¼‰")}}};const Ue=(0,z.A)(Qe,[["render",Oe]]);var Ve=Ue;const Re={class:"card shadow-sm"};function Je(e,t,s,a,n,l){return(0,i.uX)(),(0,i.CE)("div",Re,[...t[0]||(t[0]=[(0,i.Lk)("div",{class:"card-body p-4"},[(0,i.Lk)("h2",{class:"h4 fw-bold mb-2"},"æœ€æ–°æ¶ˆæ¯ï¼ˆæ›´å¤šï¼‰"),(0,i.Lk)("p",{class:"text-muted mb-0"},"å…ˆåšæ‰“ç‰ˆï¼šä¹‹å¾Œå¯æŽ¥ /mock-db/news.jsonã€‚")],-1)])])}var Be={name:"NewsListView"};const Ke=(0,z.A)(Be,[["render",Je]]);var He=Ke;const qe={class:"container py-4"},Ge={class:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3"},We={class:"h4 fw-bold mb-1"},Ye={key:0},Ze={key:1},et={key:2},tt={class:"text-muted small"},st={class:"d-flex gap-2 flex-wrap"},at={class:"card shadow-sm mb-3"},it={class:"card-body"},nt={class:"row g-2 align-items-center"},lt={class:"col-12 col-md-6"},rt={class:"col-12 col-md-3"},ot=["value"],dt={class:"col-12 col-md-3 d-flex gap-2"},ct={class:"mt-3 d-flex flex-wrap gap-2"},mt=["onClick"],ut={key:0,class:"text-muted"},ht={key:1,class:"alert alert-danger"},kt={key:2},bt={key:0,class:"alert alert-light border"},gt={class:"row g-3"},pt=["onClick"],vt=["src","alt"],wt={class:"card-body"},ft={class:"d-flex justify-content-between align-items-start gap-2"},Lt={class:"h6 fw-bold mb-1"},yt={class:"badge text-bg-danger"},Ct={class:"small text-muted mb-2"},_t={class:"me-2"},xt={class:"me-2"},Et={class:"card-text text-muted small clamp-2"},St={class:"d-flex flex-wrap gap-2 mt-2"},Xt=["onClick"],Pt={class:"card-footer bg-white border-0 pt-0"},Dt={class:"d-flex justify-content-between align-items-center"},zt={class:"small text-muted"},It={key:0},jt={class:"mt-4 text-center"};function Tt(e,t,s,l,r,o){const d=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",qe,[(0,i.Lk)("div",Ge,[(0,i.Lk)("div",null,[(0,i.Lk)("h1",We,["hot"===o.mode?((0,i.uX)(),(0,i.CE)("span",Ye,"æœ€ç†±é–€")):"latest"===o.mode?((0,i.uX)(),(0,i.CE)("span",Ze,"æœ€æ–°ä¸Šæž¶")):((0,i.uX)(),(0,i.CE)("span",et,"ä¸€ç•ªè³žæ¸…å–®"))]),(0,i.Lk)("div",tt," ç›®å‰å…± "+(0,n.v_)(o.filtered.length)+" å¥—ï¼ˆè³‡æ–™ï¼š/mock-db/gachas.jsonï¼‰ ",1)]),(0,i.Lk)("div",st,[(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:t[0]||(t[0]=e=>o.setMode("hot"))},"æœ€ç†±é–€"),(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:t[1]||(t[1]=e=>o.setMode("latest"))},"æœ€æ–°ä¸Šæž¶"),(0,i.bF)(d,{to:"/",class:"btn btn-outline-secondary btn-sm"},{default:(0,i.k6)(()=>[...t[6]||(t[6]=[(0,i.eW)("å›žé¦–é ",-1)])]),_:1})])]),(0,i.Lk)("div",at,[(0,i.Lk)("div",it,[(0,i.Lk)("div",nt,[(0,i.Lk)("div",lt,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.q=e),class:"form-control",placeholder:"æœå°‹ï¼šåç¨± / code / tagï¼ˆä¾‹å¦‚ èˆªæµ·çŽ‹ã€DEMO-001ï¼‰"},null,512),[[a.Jo,r.q,void 0,{trim:!0}]])]),(0,i.Lk)("div",rt,[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.tag=e),class:"form-select"},[t[7]||(t[7]=(0,i.Lk)("option",{value:""},"å…¨éƒ¨æ¨™ç±¤",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.allTags,e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,n.v_)(e),9,ot))),128))],512),[[a.u1,r.tag]])]),(0,i.Lk)("div",dt,[(0,i.Lk)("button",{class:"btn btn-outline-secondary w-100",onClick:t[4]||(t[4]=(...e)=>o.resetFilters&&o.resetFilters(...e))}," æ¸…é™¤ "),(0,i.Lk)("button",{class:"btn btn-danger w-100",onClick:t[5]||(t[5]=(...e)=>o.scrollTop&&o.scrollTop(...e))}," å›žé ‚éƒ¨ ")])]),(0,i.Lk)("div",ct,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.allTags.slice(0,12),e=>((0,i.uX)(),(0,i.CE)("button",{key:e,class:(0,n.C4)(["btn btn-sm",r.tag===e?"btn-danger":"btn-outline-danger"]),onClick:t=>r.tag=r.tag===e?"":e}," #"+(0,n.v_)(e),11,mt))),128))])])]),r.loading?((0,i.uX)(),(0,i.CE)("div",ut,"è®€å–ä¸­â€¦")):r.error?((0,i.uX)(),(0,i.CE)("div",ht,"è¼‰å…¥å¤±æ•—ï¼š"+(0,n.v_)(r.error),1)):((0,i.uX)(),(0,i.CE)("div",kt,[0===o.filtered.length?((0,i.uX)(),(0,i.CE)("div",bt," æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ã€‚ ")):(0,i.Q3)("",!0),(0,i.Lk)("div",gt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.filtered,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"col-12 col-sm-6 col-lg-4"},[(0,i.Lk)("div",{class:"card h-100 shadow-sm hover-card",role:"button",onClick:t=>o.goDetail(e)},[(0,i.Lk)("img",{src:e.image_url,class:"card-img-top",alt:e.name,style:{height:"180px","object-fit":"cover"}},null,8,vt),(0,i.Lk)("div",wt,[(0,i.Lk)("div",ft,[(0,i.Lk)("h3",Lt,(0,n.v_)(e.name),1),(0,i.Lk)("span",yt,"å–®æŠ½ "+(0,n.v_)(e.price),1)]),(0,i.Lk)("div",Ct,[(0,i.Lk)("span",_t,"â¤ "+(0,n.v_)(e.like_count??0),1),(0,i.Lk)("span",xt,"Â· é»žæ“Š "+(0,n.v_)(e.show_n??0),1),(0,i.Lk)("span",null,"Â· ä¸€èˆ¬æŠ½ "+(0,n.v_)(e.total_draws??"-"),1)]),(0,i.Lk)("p",Et,(0,n.v_)(e.description||"ï¼ˆå°šç„¡ä»‹ç´¹ï¼‰"),1),(0,i.Lk)("div",St,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.tags||[],e=>((0,i.uX)(),(0,i.CE)("span",{key:e,class:"badge text-bg-light border",onClick:(0,a.D$)(t=>r.tag=e,["stop"]),style:{cursor:"pointer"},title:"é»žæˆ‘ç”¨æ­¤æ¨™ç±¤ç¯©é¸"}," #"+(0,n.v_)(e),9,Xt))),128))])]),(0,i.Lk)("div",Pt,[(0,i.Lk)("div",Dt,[(0,i.Lk)("span",zt,[e.code?((0,i.uX)(),(0,i.CE)("span",It,"ä»£ç¢¼ï¼š"+(0,n.v_)(e.code),1)):(0,i.Q3)("",!0)]),t[8]||(t[8]=(0,i.Lk)("span",{class:"btn btn-sm btn-outline-danger"},"é€²å…¥æŠ½çŽ â†’",-1))])])],8,pt)]))),128))]),(0,i.Lk)("div",jt,[(0,i.bF)(d,{to:"/",class:"btn btn-outline-secondary"},{default:(0,i.k6)(()=>[...t[9]||(t[9]=[(0,i.eW)("å›žé¦–é ",-1)])]),_:1})])]))])}s(2489),s(7588),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);var Mt={name:"SeriesListView",data(){return{loading:!0,error:null,gachas:[],q:"",tag:""}},computed:{mode(){return this.$route.query.mode||""},allTags(){const e=new Set;for(const t of this.gachas)(t.tags||[]).forEach(t=>e.add(t));return Array.from(e).sort((e,t)=>e.localeCompare(t,"zh-Hant"))},sorted(){const e=[...this.gachas];return"hot"===this.mode?e.sort((e,t)=>{const s=(e.show_n||0)+(e.like_count||0),a=(t.show_n||0)+(t.like_count||0);return a-s}):"latest"===this.mode?e.sort((e,t)=>{const s=e.created_at?Date.parse(e.created_at):e.id||0,a=t.created_at?Date.parse(t.created_at):t.id||0;return a-s}):e.sort((e,t)=>(e.id||0)-(t.id||0)),e},filtered(){const e=(this.q||"").toLowerCase(),t=this.tag;return this.sorted.filter(s=>{const a=[s.name,s.code,...s.tags||[]].filter(Boolean).join(" ").toLowerCase(),i=!e||a.includes(e),n=!t||(s.tags||[]).includes(t);return i&&n})}},watch:{"$route.query.mode"(){this.scrollTop()}},async mounted(){try{const e=await fetch("/ichiban-gacha-json/mock-db/gachas.json");if(!e.ok)throw new Error("gachas.json HTTP "+e.status);const t=await e.json();this.gachas=Array.isArray(t)?t:t.items||[]}catch(e){this.error=e.message||String(e)}finally{this.loading=!1}},methods:{setMode(e){this.$router.push({path:"/series",query:{mode:e}})},resetFilters(){this.q="",this.tag=""},scrollTop(){window.scrollTo({top:0,behavior:"smooth"})},goDetail(e){this.$router.push(`/series/${e.id}`)}}};const $t=(0,z.A)(Mt,[["render",Tt],["__scopeId","data-v-6b2b3288"]]);var Nt=$t;const At={class:"card shadow-sm"};function Ft(e,t,s,a,n,l){return(0,i.uX)(),(0,i.CE)("div",At,[...t[0]||(t[0]=[(0,i.Lk)("div",{class:"card-body p-4"},[(0,i.Lk)("h2",{class:"h4 fw-bold mb-2"},"ç®¡ç†ä¸€ç•ªè³ž"),(0,i.Lk)("p",{class:"text-muted mb-0"}," å…ˆåšæ‰“ç‰ˆï¼šæ–°å¢ž / ä¿®æ”¹ / ä¸‹æž¶ï¼ˆä¹‹å¾ŒæŽ¥ MySQLï¼‰ã€‚ ")],-1)])])}var Ot={name:"AdminSeriesView"};const Qt=(0,z.A)(Ot,[["render",Ft]]);var Ut=Qt;const Vt={class:"container py-4"},Rt={key:0,class:"text-muted"},Jt={key:1,class:"alert alert-danger"},Bt={key:2,class:"row g-4"},Kt={class:"col-12 col-lg-8"},Ht={class:"d-flex justify-content-between align-items-start gap-3 flex-wrap"},qt={class:"fw-bold mb-1"},Gt={class:"text-muted small"},Wt={class:"ms-2"},Yt={class:"card shadow-sm mt-3"},Zt={class:"card-body text-center"},es={class:"fw-semibold mb-2"},ts=["src","alt"],ss={key:0,class:"text-muted small mt-2"},as={class:"d-flex justify-content-center gap-2 mt-3"},is={class:"d-flex justify-content-end mt-3"},ns=["disabled"],ls={class:"mt-3 text-muted",style:{"white-space":"pre-line"}},rs={class:"col-12 col-lg-4"},os={class:"card shadow-sm"},ds={class:"card-body"},cs={class:"list-group"},ms={class:"d-flex justify-content-between align-items-center"},us={class:"me-2"},hs=["onClick"],ks={class:"d-flex justify-content-between align-items-center"},bs={class:"me-2"},gs={class:"ms-2"},ps={class:"badge text-bg-light border"},vs={class:"modal fade",ref:"drawModalEl",tabindex:"-1"},ws={class:"modal-dialog modal-dialog-centered modal-lg"},fs={class:"modal-content rounded-4"},Ls={class:"modal-header"},ys={class:"modal-title fw-bold"},Cs={key:0},_s={key:1},xs={class:"modal-body"},Es={key:0},Ss={class:"d-flex gap-2 flex-wrap"},Xs=["disabled"],Ps=["disabled"],Ds=["disabled"],zs={class:"small text-muted align-self-center ms-2"},Is={key:0,class:"alert alert-warning mt-3 mb-0"},js={key:1},Ts={class:"d-flex justify-content-between align-items-center flex-wrap gap-2"},Ms={class:"small text-muted"},$s={class:"ticket-grid mt-3"},Ns=["disabled","onClick"],As={class:"mt-2 small text-muted"},Fs={class:"d-flex justify-content-end mt-3"},Os=["disabled"],Qs={key:3,class:"anim-overlay"},Us={class:"anim-card"},Vs={class:"fw-bold mb-2"},Rs={key:0},Js={key:1},Bs={key:2},Ks={class:"mb-3 text-muted small"},Hs={key:0},qs={key:1},Gs={class:"anim-imgwrap"},Ws=["src","alt"],Ys={key:1,class:"anim-placeholder"},Zs={class:"modal fade",ref:"resultModalEl",tabindex:"-1"},ea={class:"modal-dialog modal-dialog-centered modal-lg"},ta={class:"modal-content rounded-4"},sa={class:"modal-body"},aa={key:0,class:"text-muted"},ia={key:1,class:"row g-3"},na={class:"border rounded-4 p-3 h-100"},la={class:"fw-bold mb-1"},ra={key:0},oa={key:1},da={key:2,class:"text-muted ms-2"},ca={class:"mb-2"},ma=["src"],ua={class:"modal-footer"},ha=["disabled"];function ka(e,t,s,a,l,r){const o=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",Vt,[l.loading?((0,i.uX)(),(0,i.CE)("div",Rt,"è®€å–ä¸­â€¦")):l.error?((0,i.uX)(),(0,i.CE)("div",Jt,"è¼‰å…¥å¤±æ•—ï¼š"+(0,n.v_)(l.error),1)):((0,i.uX)(),(0,i.CE)("div",Bt,[(0,i.Lk)("div",Kt,[(0,i.Lk)("div",Ht,[(0,i.Lk)("div",null,[(0,i.Lk)("h1",qt,(0,n.v_)(l.series.name),1),(0,i.Lk)("div",Gt,[(0,i.eW)(" å–®æŠ½ "+(0,n.v_)(l.series.price)+" å…ƒ ï½œ ä¸€èˆ¬æŠ½ï¼šå‰©é¤˜ "+(0,n.v_)(r.remainingDraws)+" / "+(0,n.v_)(l.series.total_draws)+" ",1),(0,i.Lk)("span",Wt,"ï½œ æœ€å¾Œè³žï¼š"+(0,n.v_)(l.lastPrizeClaimed?"å·²é–‹å‡º":"æœªé–‹å‡º"),1)])])]),(0,i.Lk)("div",Yt,[(0,i.Lk)("div",Zt,[(0,i.Lk)("div",es,(0,n.v_)(r.currentSlide.title),1),(0,i.Lk)("img",{src:r.currentSlide.image_url,alt:r.currentSlide.title,class:"img-fluid rounded-4 border",style:{"max-height":"420px",width:"100%","object-fit":"cover"}},null,8,ts),r.currentSlide.description?((0,i.uX)(),(0,i.CE)("div",ss,(0,n.v_)(r.currentSlide.description),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",as,[(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[0]||(t[0]=(...e)=>r.prevSlide&&r.prevSlide(...e))},"ä¸Šä¸€å¼µ"),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[1]||(t[1]=(...e)=>r.nextSlide&&r.nextSlide(...e))},"ä¸‹ä¸€å¼µ")])])]),(0,i.Lk)("div",is,[(0,i.Lk)("button",{class:"btn btn-danger px-4",onClick:t[2]||(t[2]=(...e)=>r.openDrawModal&&r.openDrawModal(...e)),disabled:r.remainingDraws<=0&&l.lastPrizeClaimed}," æŠ½çŽ ",8,ns)]),(0,i.Lk)("p",ls,(0,n.v_)(l.series.description),1),(0,i.bF)(o,{to:"/",class:"btn btn-link px-0"},{default:(0,i.k6)(()=>[...t[12]||(t[12]=[(0,i.eW)("â† å›žé¦–é ",-1)])]),_:1})]),(0,i.Lk)("div",rs,[(0,i.Lk)("div",os,[(0,i.Lk)("div",ds,[t[14]||(t[14]=(0,i.Lk)("h2",{class:"h5 fw-bold mb-3"},"çŽé …æ¸…å–®",-1)),(0,i.Lk)("div",cs,[r.lastPrize?((0,i.uX)(),(0,i.CE)("button",{key:0,class:(0,n.C4)(["list-group-item last-prize-item",{claimed:l.lastPrizeClaimed}]),onClick:t[3]||(t[3]=e=>r.goToPrizeSlide(r.lastPrize))},[(0,i.Lk)("div",ms,[(0,i.Lk)("div",us,[t[13]||(t[13]=(0,i.Lk)("strong",{class:"me-2"},"æœ€å¾Œè³ž",-1)),(0,i.Lk)("span",null,(0,n.v_)(r.lastPrize.name),1)]),(0,i.Lk)("span",{class:(0,n.C4)(["badge",l.lastPrizeClaimed?"text-bg-secondary":"text-bg-warning"])},(0,n.v_)(l.lastPrizeClaimed?"å·²é–‹å‡º":"æœªé–‹å‡º"),3)])],2)):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.normalPrizesSorted,e=>((0,i.uX)(),(0,i.CE)("button",{key:e.id,class:(0,n.C4)(["list-group-item list-group-item-action",{"soldout-item":e.remaining<=0}]),onClick:t=>r.goToPrizeSlide(e)},[(0,i.Lk)("div",ks,[(0,i.Lk)("div",bs,[(0,i.Lk)("strong",null,(0,n.v_)(e.tier)+"è³ž",1),(0,i.Lk)("span",gs,(0,n.v_)(e.name),1)]),(0,i.Lk)("span",ps,(0,n.v_)(e.remaining)+" / "+(0,n.v_)(e.total),1)])],10,hs))),128))]),t[15]||(t[15]=(0,i.Lk)("div",{class:"small text-muted mt-3"}," â€» ä¸€èˆ¬æŠ½æ•¸ç”¨ç›¡æ™‚ï¼Œæœ€å¾Œè³žæœƒã€Œéš¨æœ€å¾Œä¸€è¼ªæŠ½çŽä¸€èµ·ç™¼æ”¾ã€ ",-1))])])])])),(0,i.Lk)("div",vs,[(0,i.Lk)("div",ws,[(0,i.Lk)("div",fs,[(0,i.Lk)("div",Ls,[(0,i.Lk)("h5",ys,["chooseCount"===l.drawStage?((0,i.uX)(),(0,i.CE)("span",Cs,"é¸æ“‡æŠ½çŽæ–¹å¼")):((0,i.uX)(),(0,i.CE)("span",_s,"é¸æ“‡è™Ÿç¢¼ï¼ˆ"+(0,n.v_)(l.drawCount)+" æŠ½ï¼‰",1))]),(0,i.Lk)("button",{class:"btn-close","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=(...e)=>r.resetDrawFlow&&r.resetDrawFlow(...e))})]),(0,i.Lk)("div",xs,["chooseCount"===l.drawStage?((0,i.uX)(),(0,i.CE)("div",Es,[(0,i.Lk)("div",Ss,[(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:t[5]||(t[5]=e=>r.startPick(1)),disabled:r.remainingDraws<1}," å–®æŠ½ ",8,Xs),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:t[6]||(t[6]=e=>r.startPick(5)),disabled:r.remainingDraws<5}," äº”æŠ½ ",8,Ps),(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:t[7]||(t[7]=e=>r.startPick(10)),disabled:r.remainingDraws<10}," åæŠ½ ",8,Ds),(0,i.Lk)("div",zs," ï¼ˆå‰©é¤˜ä¸€èˆ¬æŠ½ï¼š"+(0,n.v_)(r.remainingDraws)+"ï¼‰ ",1)]),0===r.remainingDraws?((0,i.uX)(),(0,i.CE)("div",Is," ä¸€èˆ¬æŠ½å·²æŠ½å®Œï¼›æœ€å¾Œè³žæœƒåœ¨ä½ æœ€å¾Œä¸€æ¬¡æŠ½çŽæ™‚ä¸€èµ·ç™¼æ”¾ï¼ˆè‹¥å°šæœªé ˜å–ï¼‰ã€‚ ")):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",js,[(0,i.Lk)("div",Ts,[(0,i.Lk)("div",Ms," é»žé¸è™Ÿç¢¼å¯éŽ–å®šï¼ˆæœ€å¤š "+(0,n.v_)(l.drawCount)+" å€‹ï¼‰ï¼›å·²æŠ½éŽæœƒæ˜¯ç°è‰²ä¸å¯é¸ ",1),(0,i.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[8]||(t[8]=(...e)=>r.systemPick&&r.systemPick(...e))}," ç³»çµ±å¹«æŠ½ ")]),(0,i.Lk)("div",$s,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.series.total_draws,e=>((0,i.uX)(),(0,i.CE)("button",{key:e,type:"button",class:(0,n.C4)(["ticket",{drawn:r.isDrawn(e),selected:l.pickedNumbers.includes(e)&&!r.isDrawn(e)}]),disabled:r.isDrawn(e),onClick:t=>r.togglePickNumber(e)},(0,n.v_)(e),11,Ns))),128))]),(0,i.Lk)("div",As,[t[16]||(t[16]=(0,i.eW)(" å·²é¸ï¼š",-1)),(0,i.Lk)("strong",null,(0,n.v_)(l.pickedNumbers.length),1),(0,i.eW)(" / "+(0,n.v_)(l.drawCount),1)]),(0,i.Lk)("div",Fs,[(0,i.Lk)("button",{class:"btn btn-danger",onClick:t[9]||(t[9]=(...e)=>r.confirmDraw&&r.confirmDraw(...e)),disabled:l.pickedNumbers.length!==l.drawCount}," ç¢ºèªæŠ½çŽ ",8,Os)])]))])])])],512),l.anim.show?((0,i.uX)(),(0,i.CE)("div",Qs,[(0,i.Lk)("button",{class:"skip-btn",onClick:t[10]||(t[10]=(...e)=>r.skipAnimation&&r.skipAnimation(...e))},"SKIP"),(0,i.Lk)("div",Us,[t[17]||(t[17]=(0,i.Lk)("div",{class:"small text-muted mb-2"},"æŠ½çŽä¸­â€¦",-1)),(0,i.Lk)("div",Vs,[l.anim.current&&l.anim.current.isLastPrize?((0,i.uX)(),(0,i.CE)("span",Rs,"æœ€å¾Œè³ž")):l.anim.current?((0,i.uX)(),(0,i.CE)("span",Js,(0,n.v_)(l.anim.current.tier)+"è³ž",1)):((0,i.uX)(),(0,i.CE)("span",Bs,"---"))]),(0,i.Lk)("div",Ks,[l.anim.current?((0,i.uX)(),(0,i.CE)("span",Hs,(0,n.v_)(l.anim.current.name),1)):((0,i.uX)(),(0,i.CE)("span",qs,"æ­£åœ¨è½‰å‹•â€¦"))]),(0,i.Lk)("div",Gs,[l.anim.current&&l.anim.current.image_url?((0,i.uX)(),(0,i.CE)("img",{key:0,src:l.anim.current.image_url,class:"anim-img",alt:l.anim.current.name},null,8,Ws)):((0,i.uX)(),(0,i.CE)("div",Ys,"ðŸŽ²"))])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Zs,[(0,i.Lk)("div",ea,[(0,i.Lk)("div",ta,[t[19]||(t[19]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title fw-bold"},"ðŸŽ‰ æŠ½çŽçµæžœ"),(0,i.Lk)("button",{class:"btn-close","data-bs-dismiss":"modal"})],-1)),(0,i.Lk)("div",sa,[0===l.drawResults.length?((0,i.uX)(),(0,i.CE)("div",aa,"ï¼ˆæ²’æœ‰çµæžœï¼‰")):((0,i.uX)(),(0,i.CE)("div",ia,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.drawResults,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"col-12 col-md-6"},[(0,i.Lk)("div",na,[(0,i.Lk)("div",la,[e.isLastPrize?((0,i.uX)(),(0,i.CE)("span",ra,"æœ€å¾Œè³ž")):((0,i.uX)(),(0,i.CE)("span",oa,(0,n.v_)(e.tier)+"è³ž",1)),e.isLastPrize?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("span",da,"ï¼ˆè™Ÿç¢¼ "+(0,n.v_)(e.number)+"ï¼‰",1))]),(0,i.Lk)("div",ca,(0,n.v_)(e.name),1),(0,i.Lk)("img",{src:e.image_url,class:"img-fluid rounded-4 border",style:{"max-height":"260px",width:"100%","object-fit":"cover"}},null,8,ma)])]))),128))]))]),(0,i.Lk)("div",ua,[t[18]||(t[18]=(0,i.Lk)("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"é—œé–‰",-1)),(0,i.Lk)("button",{class:"btn btn-danger",onClick:t[11]||(t[11]=(...e)=>r.againDraw&&r.againDraw(...e)),disabled:r.remainingDraws<=0&&l.lastPrizeClaimed}," å†æŠ½ä¸€æ¬¡ ",8,ha)])])])],512)])}s(116),s(1701),s(8237);var ba={name:"SeriesDetailView",data(){return{loading:!0,error:null,series:null,prizes:[],ticketPrizeIds:[],initialDrawnSet:new Set,drawnSet:new Set,drawStage:"chooseCount",drawCount:1,pickedNumbers:[],lastPrizeClaimed:!1,drawResults:[],slides:[],currentSlideIndex:0,anim:{show:!1,current:null,_timer:null,_endTimer:null,_pendingResults:null}}},computed:{seriesId(){return Number(this.$route.params.id)},lastPrize(){return this.prizes.find(e=>String(e.tier).includes("æœ€å¾Œ"))||null},normalPrizes(){return this.prizes.filter(e=>!String(e.tier).includes("æœ€å¾Œ"))},normalPrizesSorted(){const e=["A","B","C","D","E","F","G","H","I","J","K"],t=t=>{const s=e.indexOf(String(t||"").toUpperCase());return-1===s?999:s};return[...this.normalPrizes].sort((e,s)=>t(e.tier)-t(s.tier))},remainingDraws(){return this.normalPrizesSorted.reduce((e,t)=>e+Number(t.remaining||0),0)},currentSlide(){return this.slides[this.currentSlideIndex]||{title:"-",image_url:"",description:""}}},async mounted(){try{const e=await fetch("/ichiban-gacha-json/mock-db/gachas.json"),t=await fetch("$/ichiban-gacha-json/mock-db/prizes.json");if(!e.ok)throw new Error("gachas.json HTTP "+e.status);if(!t.ok)throw new Error("prizes.json HTTP "+t.status);const s=await e.json(),a=await t.json(),i=s.find(e=>Number(e.id)===this.seriesId)||null;if(!i)throw new Error(`æ‰¾ä¸åˆ° gachas.json ä¸­ id=${this.seriesId} çš„ä¸€ç•ªè³ž`);this.series=i,this.prizes=a.filter(e=>Number(e.gacha_id)===this.seriesId).map(e=>({...e,isLastPrize:String(e.tier).includes("æœ€å¾Œ")})),this.buildTicketMap(),this.buildSlides(),this.currentSlideIndex=0}catch(e){this.error=e.message||String(e)}finally{this.loading=!1}},methods:{openDrawModal(){this.resetDrawFlow();const e=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.drawModalEl);e?.show()},resetDrawFlow(){this.drawStage="chooseCount",this.drawCount=1,this.pickedNumbers=[]},startPick(e){this.drawCount=e,this.pickedNumbers=[],this.drawStage="pickNumbers"},systemPick(){const e=[],t=Number(this.series?.total_draws||0);for(let s=1;s<=t;s++)this.isDrawn(s)||e.push(s);this.shuffle(e),this.pickedNumbers=e.slice(0,this.drawCount).sort((e,t)=>e-t)},togglePickNumber(e){if(this.isDrawn(e))return;const t=this.pickedNumbers.indexOf(e);t>=0?this.pickedNumbers.splice(t,1):this.pickedNumbers.length>=this.drawCount||(this.pickedNumbers.push(e),this.pickedNumbers.sort((e,t)=>e-t))},confirmDraw(){if(this.pickedNumbers.length!==this.drawCount)return;const e=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.drawModalEl);e?.hide();const t=[];for(const s of this.pickedNumbers){if(this.isDrawn(s))continue;this.drawnSet.add(s);const e=this.ticketPrizeIds[s-1],a=this.prizes.find(t=>t.id===e),i=a||null;i&&!i.isLastPrize&&Number(i.remaining)>0&&(i.remaining-=1),t.push({number:s,tier:i?.tier||"?",name:i?.name||"ï¼ˆæœªçŸ¥çŽé …ï¼šè³‡æ–™ç¼ºæ¼ï¼‰",image_url:i?.image_url||"",isLastPrize:!1}),i&&this.goToPrizeSlide(i)}if(0===this.remainingDraws&&!this.lastPrizeClaimed&&this.lastPrize){this.lastPrizeClaimed=!0;const e=this.lastPrize;t.push({number:null,tier:e.tier,name:e.name,image_url:e.image_url,isLastPrize:!0}),this.goToPrizeSlide(e)}this.pickedNumbers=[],this.drawStage="chooseCount",this.startAnimation(t)},startAnimation(e){this.stopAnimationTimers();const t=[],s=this.normalPrizesSorted.filter(e=>e.image_url);for(let i=0;i<12;i++){const e=s[Math.floor(Math.random()*s.length)];e&&t.push({tier:e.tier,name:e.name,image_url:e.image_url,isLastPrize:!1})}for(const i of e)t.push(i);this.anim.show=!0,this.anim._pendingResults=e,this.anim.current=t[0]||null;let a=0;this.anim._timer=setInterval(()=>{a=(a+1)%t.length,this.anim.current=t[a]},80),this.anim._endTimer=setTimeout(()=>{this.finishAnimation()},1200)},skipAnimation(){this.finishAnimation()},finishAnimation(){this.anim.show&&(this.stopAnimationTimers(),this.anim.show=!1,this.anim.current=null,this.drawResults=this.anim._pendingResults||[],this.anim._pendingResults=null,this.openResultModal())},stopAnimationTimers(){this.anim._timer&&clearInterval(this.anim._timer),this.anim._endTimer&&clearTimeout(this.anim._endTimer),this.anim._timer=null,this.anim._endTimer=null},openResultModal(){const e=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.resultModalEl);e?.show()},againDraw(){const e=window.bootstrap?.Modal.getOrCreateInstance(this.$refs.resultModalEl);e?.hide(),setTimeout(()=>this.openDrawModal(),150)},buildTicketMap(){const e=Number(this.series?.total_draws||0),t=[];for(const i of this.normalPrizesSorted){const e=Number(i.total||0);for(let s=0;s<e;s++)t.push(i.id)}if(t.length!==e){console.warn(`[è³‡æ–™ä¸ä¸€è‡´] prizes.totalç¸½å’Œ=${t.length}, gachas.total_draws=${e}`),t.length>e&&(t.length=e);while(t.length<e)t.push(null)}this.shuffle(t),this.ticketPrizeIds=t;const s={};for(const i of this.normalPrizesSorted)s[i.id]=Math.max(0,Number(i.total||0)-Number(i.remaining||0));const a=new Set;for(let i=0;i<this.ticketPrizeIds.length;i++){const e=this.ticketPrizeIds[i];e&&((s[e]||0)>0&&(a.add(i+1),s[e]-=1))}this.initialDrawnSet=a},buildSlides(){const e=[];this.series?.image_url&&e.push({type:"banner",title:"å®£å‚³åœ–",image_url:this.series.image_url,description:""});const t=[];this.lastPrize&&t.push(this.lastPrize),t.push(...this.normalPrizesSorted);for(const s of t)e.push({type:"prize",prizeId:s.id,title:`${s.isLastPrize?"æœ€å¾Œè³ž":s.tier+"è³ž"} ${s.name}`,image_url:s.image_url,description:s.description||""});this.slides=e},prevSlide(){this.slides.length&&(this.currentSlideIndex=(this.currentSlideIndex-1+this.slides.length)%this.slides.length)},nextSlide(){this.slides.length&&(this.currentSlideIndex=(this.currentSlideIndex+1)%this.slides.length)},goToPrizeSlide(e){const t=this.slides.findIndex(t=>"prize"===t.type&&t.prizeId===e.id);t>=0&&(this.currentSlideIndex=t)},isDrawn(e){return this.initialDrawnSet.has(e)||this.drawnSet.has(e)},shuffle(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}}},beforeUnmount(){this.stopAnimationTimers()}};const ga=(0,z.A)(ba,[["render",ka],["__scopeId","data-v-1129e32a"]]);var pa=ga;const va=[{path:"/",name:"home",component:Pe},{path:"/register",name:"register",component:Ve},{path:"/news",name:"news",component:He},{path:"/series",name:"series",component:Nt},{path:"/series/:id",name:"seriesDetail",component:pa,props:!0},{path:"/admin/series",name:"adminSeries",component:Ut}];var wa=(0,T.aE)({history:(0,T.Bt)(),routes:va});(0,a.Ef)(j).use(wa).mount("#app")}},t={};function s(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,a,i,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],n=e[c][2];for(var r=!0,o=0;o<a.length;o++)(!1&n||l>=n)&&Object.keys(s.O).every(function(e){return s.O[e](a[o])})?a.splice(o--,1):(r=!1,n<l&&(l=n));if(r){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,i,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,n,l=a[0],r=a[1],o=a[2],d=0;if(l.some(function(t){return 0!==e[t]})){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(o)var c=o(s)}for(t&&t(a);d<l.length;d++)n=l[d],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},a=self["webpackChunkichiban_gacha_json"]=self["webpackChunkichiban_gacha_json"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],function(){return s(6922)});a=s.O(a)})();
//# sourceMappingURL=app.7eedff86.js.map
